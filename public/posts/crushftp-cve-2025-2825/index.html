<!DOCTYPE html>
<html class="no-js" lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CVE 2025-2825 - CrushFTP Authentication Bypass Analysis - </title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo logo--mixed">
		<a class="logo__link" href="/" title="PwnFuzz" rel="home">
			<div class="logo__item logo__imagebox">
					<img class="logo__img" src="/img/pwnfuzz.png">
				</div><div class="logo__item logo__text">
					<div class="logo__title">PwnFuzz</div>
					<div class="logo__tagline">Fuzz. Pwn. Repeat.</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">About</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/tags/">
				
				<span class="menu__text">Tags</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>

		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CVE 2025-2825 - CrushFTP Authentication Bypass Analysis</h1>
			
		</header>
		
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#inside-the-vulnerability-a-deep-dive">Inside the Vulnerability: A Deep Dive</a></li>
        <li><a href="#exploit-in-action-performing-auth-bypass">Exploit in Action: Performing Auth Bypass</a></li>
        <li><a href="#evaluating-patched-version">Evaluating Patched Version</a></li>
      </ul>
    </li>
  </ul>
</nav>
	</div>
</div><div class="content post__content clearfix">
			<p>After the <a href="https://thehackernews.com/2025/03/new-security-flaws-found-in-vmware.html">news</a> made it’s way to my feeds, having worked on the CrushFTP’s <a href="https://www.notion.so/CVE-2025-2825-1c553a570fe780998981fe4e2c1694e1?pvs=21">CVE-2024-4040</a> vulnerability analysis, this sounded like a good thing to do over and maybe I could write the exploit before anyone but unfortunately <a href="https://projectdiscovery.io/blog/crushftp-authentication-bypass">Project Discovery</a> guys beat me to it. Anyways, enough story, let’s dive into the vulnerability:</p>
<ul>
<li>CrushFTP versions 10.0.0 through 10.8.3 and 11.0.0 through 11.3.0 are affected by a vulnerability that may result in unauthenticated access. Remote and unauthenticated HTTP requests to
CrushFTP may allow attackers to gain unauthorized access.</li>
</ul>
<p>CrushFTP docker versions are the best source to achieve the specific version to analyze as the one listed within the CrushFTP website just points to latest release, since we need to perform patch diffing for the latest version (let’s say N) and previous version (N-1). The authentication bypass vulnerability was patched in <a href="https://www.crushftp.com/version11.html">11.3.1</a> of CrushFTP11, so we need 11.3.0 to perform the diffing of files and code changes made between these two.</p>
<h3 id="inside-the-vulnerability-a-deep-dive">Inside the Vulnerability: A Deep Dive</h3>
<p>Having both versions of docker image locally, we retrieve the <code>CrushFTP.jar</code> file, then as we do with all jar files, we decompile them and retrieve the Java files, once that is done, I quickly wrote a script to compare the MD5 checksums of files from the both versions and if they don’t match from the old one, it probably has been updated or created.</p>

<p>Running the script shows that there are couple of files that has been changed from the last version (N-1), knowing that this vulnerability exist for the HTTP service, the ServerSessions file stands out the most.</p>

<p>Executing <code>diff</code> command on it will show the lines removed and added which will help in laying out the ground for us to work with.</p>
<p><img src="/img/crushftp-cve-2025-2825/image_0.png" alt="Untitled"></p>
<p>Out of all the additions and deletions, there are few things that stands out the most, the conditional check for the <code>login_user_pass</code> and how it has changed, looking into the <a href="http://ServerSessionHTTP.java"><code>ServerSessionHTTP.java</code></a> file, we see that the function named <code>loginCheckHeaderAuth</code> , this function parses the authorization header and validate if the requested methods and their respective values are valid or not. If we look closely at the conditional branch, first it checks if the <code>Authorization</code> header starts from <code>AWS4-HMAC</code> , it finds the <code>=</code> character and then it takes the value of it and removes the trailing <code>/</code> character to take it as username and most importantly it by default sets the value of <code>lookup_user_pass</code> as <code>true</code> , followed by the value set, it checks if the header value has a tilde character in it and if it is there, then it parses it and set the value of <code>login_user_pass</code> as <code>false</code> , followed by that it a <code>login_user_pass</code> lookup is done on the retrieved values from header with the <code>lookup_user_pass</code> , <code>user_name</code> and then  empty password as well. (The reason for empty password is the main part of vulnerability as we will be taking advantage of the missing check for the <code>lookup_user_pass</code> value correctly)</p>

<p>Checking the <code>login_user_pass</code> function, it contains the login for authentication of how the username and password is handled, since with how the S3 authentication logic implemented, the expected values from the header have to contain the username and password along with other details like following:</p>

<p>After some checks within the <code>login_user_pass</code> function whether it contains any specific keywords or not, since it does not matter to the flow we are following, we can move to the important line within this function which is the function call <code>this.verify_user</code> , our next target for analysis.</p>

<p>Looking into the <code>verify_user</code> , we know that it passes the value of <code>user_name</code> as parsed from the <code>Authorization</code> header and <code>anyPass</code> value as <code>true</code> , eventually after comparing certain values within the logic such as checking whether the password has been provided or other attributes, it calls the <code>UserTools.ut.verify_user</code> from <code>./11.3.0/crushftp/handlers/UserTools.java</code> file</p>

<p>Looking into the <code>verify_user</code> function within the <a href="http://UserTools.java"><code>UserTools.java</code></a> file, we see that it checks certain values for the password to identify it’s not of any hash type, then there stands a particular conditional branch which checks whether the given username has any of the XML file (this is used to store user’s information) and then if it does, it checks the <code>anyPass</code> value and if it is true (which it will be) and user existed, it will return the <code>user</code> meaning that user has been verified:</p>

<hr>
<p>So an overview of this would be that the fact <code>lookup_user_pass</code> value was set to <code>true</code> by default once the S3 authentication process begins and it takes in the username provided within the header, this was later fixed, which we will analyze at the end.</p>
<h3 id="exploit-in-action-performing-auth-bypass">Exploit in Action: Performing Auth Bypass</h3>
<p>Anyways, so at this point, our Proof-Of-Concept will look like:</p>

<p>But there are few things to consider as well, CrushFTP keeps the session details using <code>Cookies</code> and if you have fiddled around with enough, you would know that the two things that it validates are:</p>
<ul>
<li><code>CrushAuth</code> - A combination of timestamp and underscore followed by 30 random characters unique for each sessions</li>
<li><code>currentAuth</code> - Last 4 digits of the 30 random characters for <code>CrushAuth</code> value, this value is also sent as part of certain requests</li>
</ul>
<p>But since we already bypass the need of credentials, then we can just craft our own values for those cookies and send the request with the crafted <code>Authorization</code> header value.</p>

<p>Sending the request to get the current session user, we could see that the CrushFTP thinks the current user session which requested is <code>crushadmin</code></p>
<p><img src="/img/crushftp-cve-2025-2825/image_1.png" alt="Untitled"></p>
<p>We can also try to list the directories, it may seem the response has no such data we can use, this is because the docker I had was not configured due to docker image limitations.</p>
<p><img src="/img/crushftp-cve-2025-2825/image_2.png" alt="Untitled"></p>
<p>Now that is done, I created a quick python script which accepts the URL and performs the check on the remote host whether to see if it is vulnerable or not:</p>

<p>Proof-Of-Concept can be found <a href="https://github.com/pwnfuzz/POCs/blob/main/CVE%202025-2825">here</a>.</p>
<p><img src="/img/crushftp-cve-2025-2825/image_3.png" alt="Untitled"></p>
<h3 id="evaluating-patched-version">Evaluating Patched Version</h3>
<p>Looking into the code, we see that now the applications checks whether the S3 authentication is supported or not, if not it will terminate the request with <code>AWS4-HMAC...</code> type. This is a good fix in itself as previously one can do authentication bypass even on servers with no S3 configuration.</p>

<p>The following lines were added instead of the <code>login_user_check</code> call that we saw before, here the application tries to fetch the user’s <code>linkedServer</code> property which we can safely assume to be one of those properties which specifies whether the user has S3 authentication is enabled. If it is, internally it performs the proper check for the provided password.</p>

<p>It is recommended to update the CrushFTP version to 11.3.1 as this vulnerability can be very severe if targeted cleverly.</p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 0 0 0-6 3 3 0 0 0 0 6"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/cve-2025-2825/" rel="tag">CVE-2025-2825</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/java/" rel="tag">Java</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/auth-bypass/" rel="tag">auth-bypass</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/logic-flaw/" rel="tag">logic-flaw</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>

<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="D4mianwayne avatar" src="/img/profile-placeholder.jpg" class="avatar" height="90" width="90">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">About D4mianwayne</span>
	</div>
	<div class="authorbox__description">
		Vulnerability Researcher, Exploit Developer
	</div>
</div>

<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/hpe-irs-cve-deep-dive/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Exploring Recent CVEs in HPE Insight Remote Support</p>
		</a>
	</div>
</nav>


			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<input class="widget-search__field" type="search" placeholder="Search…" value="" name="q" aria-label="Search…">
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="http://localhost:1313/">
	</form>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/posts/crushftp-cve-2025-2825/">CVE 2025-2825 - CrushFTP Authentication Bypass Analysis</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/hpe-irs-cve-deep-dive/">Exploring Recent CVEs in HPE Insight Remote Support</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/ivanti-endpoint-manager-xxe-cve-2024-37397/">CVE 2024-37397 - Ivanti Endpoint Manager XXE Vulnerability</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/crushftp-cve-2024-4040/">CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">Categories</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/categories/cve-analysis/">CVE Analysis</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/java/" title="Java">Java (3)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rce/" title="RCE">RCE (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/xxe/" title="XXE">XXE (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/.net/" title=".NET">.NET (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/auth-bypass/" title="Auth-Bypass">Auth-Bypass (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-37297/" title="CVE-2024-37297">CVE-2024-37297 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-4040/" title="Cve-2024-4040">Cve-2024-4040 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53675/" title="CVE-2024-53675">CVE-2024-53675 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53676/" title="CVE-2024-53676">CVE-2024-53676 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2025-2825/" title="CVE-2025-2825">CVE-2025-2825 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/logic-flaw/" title="Logic-Flaw">Logic-Flaw (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/oob-xxe/" title="OOB-XXE">OOB-XXE (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/path-traversal/" title="Path Traversal">Path Traversal (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ssti/" title="SSTI">SSTI (1)</a>
	</div>
</div>

</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2025 .
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>