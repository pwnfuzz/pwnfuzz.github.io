<!DOCTYPE html>
<html class="no-js" lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Exploring Recent CVEs in HPE Insight Remote Support - </title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo logo--mixed">
		<a class="logo__link" href="/" title="PwnFuzz" rel="home">
			<div class="logo__item logo__imagebox">
					<img class="logo__img" src="/img/pwnfuzz.png">
				</div><div class="logo__item logo__text">
					<div class="logo__title">PwnFuzz</div>
					<div class="logo__tagline">Fuzz. Pwn. Repeat.</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">About</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/tags/">
				
				<span class="menu__text">Tags</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>

		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Exploring Recent CVEs in HPE Insight Remote Support</h1>
			
		</header>
		<div class="content post__content clearfix">
			<p>In this post, we’ll delve into two critical vulnerabilities recently discovered in the HPE Insight Remote Support (IRS) application, versions prior to <code>v7.14.0.629</code>. These vulnerabilities—CVE-2024-53675 (unauthenticated XXE vulnerability) and CVE-2024-53676 (Remote Code Execution, or RCE vulnerability)—pose significant security risks, allowing unauthorized access and arbitrary code execution on vulnerable systems.</p>
<h1 id="overview">Overview</h1>
<p>With the holiday vibes going around, I had no plans on releasing any posts but as I was working through this, I learned few things about secure coding practices and hunting for these reported vulnerabilities gives a good practice to understand the researcher&rsquo;s thought process and perhaps perform variant analysis in a similar situation. The Insight Remote Support application by HPE is used to gather information and statistics for multiple other hardwares such as printers and stuff, there are certain servlets exposed through web UI, accessible without authentication allowing exploitation of all the reported vulnerabilities much easier and with no dependency on credentials. A bit of background in regards with the software is that the web server is based on Tomcat server and perhaps you may have guessed by now the backend is developed on Java.</p>
<h1 id="exploiting-xxe-in-hpe-insight-remote-support-cve-2024-53675">Exploiting XXE in HPE Insight Remote Support (CVE-2024-53675)</h1>
<p>Lately for almost all of the vulnerabilities that I tried to do n-day analysis on turned out to be XXE either due to it&rsquo;s straightforwardness or setup issues that only exposes that XXE vulnerable endpoint. This was no different either as I ran into setup issues with this one as well, one thing that no one mentions is how hard it is to actually get applications like this to work if you&rsquo;re going to exploit vulnerabilities to full extent. Enough talk, let&rsquo;s get down to business.</p>
<p>As per ZDI Advisory:</p>
<blockquote>
<p>This vulnerability allows remote attackers to disclose sensitive information on affected installations of Hewlett Packard Enterprise Insight Remote Support. Authentication is not required to exploit this vulnerability.
The specific flaw exists within the implementation of the validateAgainstXSD method. Due to the improper restriction of XML External Entity (XXE) references, a crafted document specifying a URI causes the XML parser to access the URI and embed the contents back into the XML document for further processing. An attacker can leverage this vulnerability to disclose files in the context of SYSTEM.</p></blockquote>
<h4 id="deep-dive-into-xxe-vulnerability-in-validateagainstxsd">Deep Dive into XXE Vulnerability in <code>validateAgainstXSD</code></h4>
<p>This vulnerability is mentioned as an unauthenticated XXE vulnerability, the problem stems from <code>validateAgainstXSD</code> , this function belonged to <code>ucacore</code> library which had number of utility funtions, one of them was our target <code>validateAgainstXSD</code>. The deivce registration request (as per WSDL documentation accessible over <code>/DeviceRegistration/DeviceRegistration.svc?wsdl</code> ) expects XML content within <code>identifier</code> parameter, this later gets passed to <code>com.hp.it.sa.helpers.RegisterDeviceHelper.java</code> class having <code>validateDeviceIDsXML</code> which later passses the XML content to <code>validateAgainstXSD</code>.</p>

<p>As we can see, the <code>validateAgainstXSD</code> does not have any predefined rules for blocking DTDs and entitites. For the <code>SAXSource</code> there are some rules that has to be defined for restricting loading of DTDs.</p>

<h4 id="exploiting-the-xxe-vulnerability-proof-of-concept">Exploiting the XXE Vulnerability: Proof of Concept</h4>
<p>For the exploitation of this, I hosted a <code>malicious.dtd</code> as it will be an OOB XXE exploit, then we send a crafted payload which will load this hosted DTD which then reads the specified file and send it to our listener. This resulted in retrieval of content from the specified file, unfortunately the underlying library sends only the first line of the file as it is unable to parse the newline characters hence making this overall attack limited in terms of exfiltrating data. Similar case was identified in the <a href="https://github.com/pwnfuzz/POCs/tree/main/CVE%202024-38653">Ivanti Avalanche XXE</a> vulnerability which I wrote an exploit for few months back.</p>
<p>Following DTD is used for showcasing the file read via OOB:</p>

<p><code>RegisterDevice</code> request for triggering XXE attack:</p>

<p>Full POC can  be found <a href="https://github.com/pwnfuzz/POCs/tree/main/CVE%202024-53675">here</a>.</p>
<p><img src="/img/hpe-deep-dive/xxe-exploit.jpg" alt="XXE Exploit"></p>
<h1 id="exploiting-remote-code-execution-in-hpe-irs-cve-2024-53676">Exploiting Remote Code Execution in HPE IRS (CVE-2024-53676)</h1>
<blockquote>
<p>This vulnerability allows remote attackers to execute arbitrary code on affected installations of Hewlett Packard Enterprise Insight Remote Support. Authentication is not required to exploit this vulnerability.
The specific flaw exists within the implementation of the <code>processAtatchmentDataStream</code> method. The issue results from the lack of proper validation of a user-supplied path prior to using it in file operations. An attacker can leverage this vulnerability to execute code in the context of SYSTEM.</p></blockquote>
<h4 id="understanding-the-rce-vulnerability-in-processatatchmentdatastream">Understanding the RCE Vulnerability in <code>processAtatchmentDataStream</code></h4>
<p>The description is self-explanatory and if you have ever had the chance to look at a vulnerable code handling file upload written in Java, you can spot it under a minute.
Connecting the sink <code>attachment</code> to the source was not hard, as we already had an idea of the exposed endpoints accepting requests. The <code>com.hp.it.sa.helpers.DataPackageReceiverWebSvcHelper.java</code>, this source file had a method name <code>processRequestForAttachment</code> which performed several check and later calls <code>processAttachments</code> from <code>attachmentsHelper</code> class.</p>

<p>The <code>processAtatchmentDataStream</code> function processes the attached file sent via the request and specifies the destination directory where to save the file but the problem occurs at the <code>attachmentName</code> handling, since there is no check for characters for traversal i.e. <code>.</code>, <code>..</code>, <code>/</code> , this will in turn if something like <code>../../</code> is specified, it will allow the attacker to set the <code>attachmentFileLocation</code> as an entirely different directory eventually saving the specified file to that destination. From a broader perspecitve, as we are aware of the techstack being Java, this will allow us to upload a crafted JSP to the web server directory and performing the RCE. Unfortunately, the instance I had could not be registered for some reason limiting my tests for performing full exploitation.</p>

<h4 id="theoretical-exploitation-setup-issues-preventing-full-rce">Theoretical Exploitation: Setup Issues Preventing Full RCE</h4>
<p>With this information in hand, crafting a request was not a problem as the WSDL(https://localhost:7906/DataPackageReceiver/DataPackageReceiverService.svc?wsdl) gives the information about the parameters and the expected data within them. Utilizing it, the following script crafts the SOAP request that contains some required parameters, this is based on the script we used for XXE attack in the previous one.</p>

<p>Unfortunately, which as we saw it coming suggests that <code>oosId</code> is not found, <code>oosID</code> here refers to the device ID assigned during the registration, if this ID is not found within the registred instance it will not process the request further and invokes the error hence not even processing the attachment sent via the request.</p>

<p><img src="/img/hpe-deep-dive/rce-fail.jpg" alt="Failed Exploitation Attempt"></p>
<p>Checking the logs, we observe that the same messaged was logged into the file and there is an additional information stating that the attachment processing was aborted by the application.</p>

<p>Checking the function which was handling the attachments, it does not perform the processing.</p>

<p>Based on our analysis of this vulnerability, it’s clear that exploiting it requires the <code>gdid</code> (<code>oosId</code>) and a registration token, which limits the potential for a fully unauthenticated attack. While the exploitation process itself is straightforward, the need for these specific values introduces some dependency. I’ve uploaded the <a href="https://github.com/pwnfuzz/POCs">PoCs to GitHub</a>, and from the analysis conducted, a theoretical exploit with hardcoded values can certainly trigger this path traversal vulnerability. Once the necessary items are obtained, anyone assessing this vulnerability should be able to fully exploit it, leveraging RCE via path traversal.</p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 0 0 0-6 3 3 0 0 0 0 6"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/cve-2024-53676/" rel="tag">CVE-2024-53676</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/cve-2024-53675/" rel="tag">CVE-2024-53675</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/java/" rel="tag">Java</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/xxe/" rel="tag">XXE</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/rce/" rel="tag">RCE</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/path-traversal/" rel="tag">Path Traversal</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>




			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<input class="widget-search__field" type="search" placeholder="Search…" value="" name="q" aria-label="Search…">
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="http://localhost:1313/">
	</form>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/posts/crushftp-cve-2025-2825/">CVE 2025-2825 - CrushFTP Authentication Bypass Analysis</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/hpe-irs-cve-deep-dive/">Exploring Recent CVEs in HPE Insight Remote Support</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/ivanti-endpoint-manager-xxe-cve-2024-37397/">CVE 2024-37397 - Ivanti Endpoint Manager XXE Vulnerability</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/crushftp-cve-2024-4040/">CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">Categories</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/categories/cve-analysis/">CVE Analysis</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/java/" title="Java">Java (3)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rce/" title="RCE">RCE (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/xxe/" title="XXE">XXE (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/.net/" title=".NET">.NET (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/auth-bypass/" title="Auth-Bypass">Auth-Bypass (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-37297/" title="CVE-2024-37297">CVE-2024-37297 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-4040/" title="Cve-2024-4040">Cve-2024-4040 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53675/" title="CVE-2024-53675">CVE-2024-53675 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53676/" title="CVE-2024-53676">CVE-2024-53676 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2025-2825/" title="CVE-2025-2825">CVE-2025-2825 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/logic-flaw/" title="Logic-Flaw">Logic-Flaw (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/oob-xxe/" title="OOB-XXE">OOB-XXE (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/path-traversal/" title="Path Traversal">Path Traversal (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ssti/" title="SSTI">SSTI (1)</a>
	</div>
</div>

</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2025 .
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>