<!DOCTYPE html>
<html class="no-js" lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Introduction to ROP - </title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo logo--mixed">
		<a class="logo__link" href="/" title="PwnFuzz Blog" rel="home">
			<div class="logo__item logo__imagebox">
					<img class="logo__img" src="/img/pwnfuzz.png">
				</div><div class="logo__item logo__text">
					<div class="logo__title">PwnFuzz Blog</div>
					<div class="logo__tagline">Just another site</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">About</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/tags/">
				
				<span class="menu__text">Tags</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>

		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Introduction to ROP</h1>
			
		</header>
		<div class="content post__content clearfix">
			<p>This blog post will let you know about the ROP or Return Oriented Programming.</p>
<!-- more -->
<h1 id="what-is-rop">What is ROP?</h1>
<p>Return Oriented Programming is a modern method of exploiting a binary that will allow us to take control of the stack and the abuse program&rsquo;s control flow by the help of gadgets.
Often times, this technique is used to exploit a binary which takes input without bound checking that will result in overflow of the memory in which the input is being stored resulting in segmentation fault.
This method is only used when we have handful of gadgets i.e. instruction sequences ending with <strong>&ldquo;ret&rdquo;</strong> or byte <strong>&ldquo;c3&rdquo;</strong>.</p>
<h1 id="prerequisities">Prerequisities</h1>
<p>Since, this method of exploitation is based on analyzation of functions and memory address which requires some basic reverse engineering and understanding of assembly language.</p>
<p>So, for reverse engineering you can refer to following resources in order to learn ROP.</p>
<ul>
<li><a href="https://medium.com/@jacob16682/reverse-engineering-using-radare2-588775ea38d5">Reverse Engineering with radare2</a></li>
<li><a href="https://medium.com/@rickharris_dev/reverse-engineering-using-linux-gdb-a99611ab2d32">Reverse Engineering with gdb</a></li>
</ul>
<p>As of now, I&rsquo;ve only included radare2 and gdb which is going to be used for this series.</p>
<p>For Assembly, you can refer the follwoings:-</p>
<ul>
<li><a href="http://www.cs.princeton.edu/courses/archive/spr17/cos217/lectures/13_Assembly1.pdf">Assembly Language Guide 1</a></li>
<li><a href="https://www.cs.virginia.edu/~evans/cs216/guides/x86.html">Assembly Language Guide 2</a></li>
</ul>
<h1 id="tools">Tools</h1>
<p>This can be a little long because <strong>the more the merrier</strong>.</p>
<p>First off, we need something to analyze the binary.</p>
<h5 id="radare2">Radare2</h5>
<p>If you&rsquo;ve ever tried binary analysis and reverse enginnering you must have come across radare2, which is a great binary analysis CLI tool and it has a built-in <strong>gadget</strong> finder.</p>
<h5 id="gdb-peda">GDB-PEDA</h5>
<p>This is Python Exploit Development Assitance plugin for GDB which can be found <a href="https://github.com/longld/peda">here</a>.</p>
<h5 id="pwntools">Pwntools</h5>
<p>This is absolutely a great python library which will help you with execution of your exploit by providing helpful functions, which can be get from <a href="https://github.com/arthaud/python3-pwntools">here</a>.</p>
<h5 id="ropper">Ropper</h5>
<p>This is also a great tool for finding gadgets within a binary, which can be obtained from <a href="https://github.com/sashs/Ropper">here</a>.</p>
<h1 id="finding-gadgets">Finding Gadgets</h1>
<p>From my experience as of now, I&rsquo;ve used <strong>ropper</strong> and radare2&rsquo;s built-in function <strong>/R &lt; instruction &gt;</strong>. With the use of these two tools you&rsquo;ll have the gadgets which will help you in bypassing DEP(Data Execution Prevention) hence, executing your payload.</p>
<h3 id="use-of-gadgets">Use of gadgets</h3>
<p>So, as of now you know that in order to build a ROP chain we have to get the binary&rsquo;s corresponding gadgets. Now, I&rsquo;ll tell you what is the <strong>exact</strong> use of gadget is.</p>
<h5 id="loading-constants-to-register">Loading Constants to Register</h5>
<p>With the help of ropper or radare2 you can find the <code>pop</code> instruction with a <code>ret</code> which can be used to store a constant into stack for further use.
Let a gadget be <code>pop edi, ret</code>, this will pop the <code>edi</code> register value from the stack and return the address to top of the stack.</p>
<h6 id="system-call">System Call</h6>
<p>System call i.e. <code>int 0x80</code> followed by <code>ret</code> instruction can be used to interrupt a kernel call that we have setup using previous gadget.
Following are the system call gadgets:-</p>
<ul>
<li><code>int 0x80; ret</code></li>
<li><code>call gs:[0x10]; ret</code></li>
</ul>
<h3 id="gadget-to-lookout">Gadget to lookout</h3>
<p>There are some gadget which are better left alone i.e. we need to avoid these gadgets in order to avoid corruption of the stack frames.</p>
<ul>
<li>Gadgets with <code>pop ebp; ret</code> will mess our stack frames.</li>
<li>Gadgets ending in pop ebp followed by ret or have the instruction pop ebp. Will also mess up our stack frame.</li>
</ul>
<p>Sometimes these gadgets dont affect the overall execution of ROP shell. It depends on the execution
flow and will it be interrupted by changing the frame pointer.</p>
<h1 id="continuing-the-series">Continuing the series</h1>
<p>This blogpost will help you in understanding the what and why of Revserse Oriented Programming. All of the resources will help you in understanding the Assembly and a little of reverse engineering.</p>
<p>Next I&rsquo;ll be posting how to get build a ROP chain from binary. Until then, read out all the resoures.</p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 0 0 0-6 3 3 0 0 0 0 6"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/rop-pwn-bof/" rel="tag">rop, pwn, bof</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>




			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<input class="widget-search__field" type="search" placeholder="Search…" value="" name="q" aria-label="Search…">
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="http://localhost:1313/">
	</form>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/posts/crushftp-cve-2025-2825/">CVE 2025-2825 - CrushFTP Authentication Bypass Analysis</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/hpe-irs-cve-deep-dive/">Exploring Recent CVEs in HPE Insight Remote Support</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/ivanti-endpoint-manager-xxe-cve-2024-37397/">CVE 2024-37397 - Ivanti Endpoint Manager XXE Vulnerability</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/crushftp-cve-2024-4040/">CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/soccer-htb/">HackTheBox - Soccer</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">Categories</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/categories/cve-analysis/">CVE Analysis</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/hackthebox/">HackTheBox</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/pwning/">Pwning</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/vulnhub/">Vulnhub</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/nmap-ctf-vulnhub/" title="Nmap, Ctf, Vulnhub">Nmap, Ctf, Vulnhub (4)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/java/" title="Java">Java (3)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rce/" title="RCE">RCE (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/xxe/" title="XXE">XXE (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/.net/" title=".NET">.NET (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/auth-bypass/" title="Auth-Bypass">Auth-Bypass (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-37297/" title="CVE-2024-37297">CVE-2024-37297 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-4040/" title="Cve-2024-4040">Cve-2024-4040 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53675/" title="CVE-2024-53675">CVE-2024-53675 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53676/" title="CVE-2024-53676">CVE-2024-53676 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2025-2825/" title="CVE-2025-2825">CVE-2025-2825 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/dstat-sqlmap-upstream_proxy-websocket/" title="Dstat, Sqlmap, Upstream_proxy, Websocket">Dstat, Sqlmap, Upstream_proxy, Websocket (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/logic-flaw/" title="Logic-Flaw">Logic-Flaw (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/oob-xxe/" title="OOB-XXE">OOB-XXE (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/path-traversal/" title="Path Traversal">Path Traversal (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pwn-hackthebox-v8-kernel-heap-tcache-libc-2.29/" title="Pwn, Hackthebox, V8, Kernel, Heap, Tcache, Libc-2.29">Pwn, Hackthebox, V8, Kernel, Heap, Tcache, Libc-2.29 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pwn-tcache-libc-2.27-hackthebox/" title="Pwn, Tcache, Libc-2.27, Hackthebox">Pwn, Tcache, Libc-2.27, Hackthebox (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-bof-ret2csu-ctf/" title="Rop, Bof, Ret2csu, Ctf">Rop, Bof, Ret2csu, Ctf (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-pwn-bof/" title="Rop, Pwn, Bof">Rop, Pwn, Bof (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-pwn-radare2-pwntools/" title="Rop, Pwn, Radare2, Pwntools">Rop, Pwn, Radare2, Pwntools (1)</a>
		<a class="widget-taglist__link widget__link btn widget-taglist__link--all" href="/tags/">View all tags →</a>
	</div>
</div>

</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2025 .
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>