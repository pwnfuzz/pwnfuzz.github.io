<!DOCTYPE html>
<html class="no-js" lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Vulnhub - Symfonos - </title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo logo--mixed">
		<a class="logo__link" href="/" title="PwnFuzz Blog" rel="home">
			<div class="logo__item logo__imagebox">
					<img class="logo__img" src="/img/pwnfuzz.png">
				</div><div class="logo__item logo__text">
					<div class="logo__title">PwnFuzz Blog</div>
					<div class="logo__tagline">Just another site</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">About</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/tags/">
				
				<span class="menu__text">Tags</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>

		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Vulnhub - Symfonos</h1>
			
		</header>
		<div class="content post__content clearfix">
			<p>Today, we are going to pwn Symfonos from Vulnhub.</p>
<!-- more -->
<h3 id="machine-setup">Machine Setup</h3>
<p>Nothing much to setup in the machine, just import it to Virtualbox and choose the networking setting as per your ease, I chose the Bridge Networking as it&rsquo;s easy to setup.</p>
<h2 id="methodology">Methodology</h2>
<ul>
<li>Nmap scan of the machine.</li>
<li>Checking the SMB server for files.</li>
<li>Checking Helios folder for important files.</li>
<li>Discovering the WordPress website in <code>/h3l105</code> route.</li>
<li>Scanning website for the vulnerabilities via wpscan.</li>
<li>Exloiting Mail Masta 1.0 Plugin for LFI(Local File Inclusion).</li>
<li>Enumerating SMTP server.</li>
<li>Using SMTP for getting a reverse shell thrrough <code>/var/mail/helios</code> as Helios on machine.</li>
<li>Gaining root peivileges by exploiting <code>/opt/statuscheck</code> binary.</li>
</ul>
<h1 id="nmap">Nmap</h1>
<p>Let&rsquo;s get started, using <code>nmap -sV -sC -A 192.168.43.12</code> reveals HTTP, SSH, SMTP, and SMB.</p>
<p><img src="/img/symfonos/symfonosnmap.png" alt=""></p>
<h1 id="smb-service-enumeration">SMB service enumeration</h1>
<p>Honestly speaking, I&rsquo;ve had some problems using <code>smbclient</code> so I usually take the help of inbulit File application connect to server feature.
So moving to File, I connectedto the server and there were two folders, first <strong>Anonymous</strong> and second <strong>Helios</strong>, Helios folder was password protected and Anonymous was avilable to everyone so I checked <strong>Anonymous</strong> folder and there was a file named as <code>attention.txt</code>.</p>
<p><img src="/img/symfonos/symfonossmb.png" alt=""></p>
<p>It has following information:-</p>
<hr>
<blockquote>
<p>Can users please stop using passwords like &rsquo;epidioko&rsquo;, &lsquo;qwerty&rsquo; and &lsquo;baseball&rsquo;! Next person I find using one of these passwords will be fired!</p></blockquote>
<p>-Zeus</p>
<hr>
<p>So, using those password one by one for helios folder reveals folder&rsquo;s files with password <code>qwerty</code>.
It has 2 files <code>research.txt</code> and <code>todo.txt</code>.</p>
<hr>
<p>research.txt</p>
<blockquote>
<p>Helios (also Helius) was the god of the Sun in Greek mythology. He was thought to ride a golden chariot which brought the Sun across the skies each day from the east (Ethiopia) to the west (Hesperides) while at night he did the return journey in leisurely fashion lounging in a golden cup. The god was famously the subject of the Colossus of Rhodes, the giant bronze statue considered one of the Seven Wonders of the Ancient World.</p></blockquote>
<hr>
<p>Not relevant.</p>
<hr>
<p>todo.txt</p>
<blockquote>
<ol>
<li>Binge watch Dexter</li>
<li>Dance</li>
<li>Work on /h3l105</li>
</ol></blockquote>
<hr>
<p>There <code>/h3l105</code> is our focus.</p>
<h1 id="wordpress-enumeration">WordPress Enumeration</h1>
<p>So, accesing to <code>http://192.168.43.12/h3l105</code> reveals a wordpress website with login, post, castegories and other link.</p>
<hr>
<p>Note</p>
<blockquote>
<p>When you try to acces <code>/wp-login.php</code>, you&rsquo;ll recieve a error so to resolve that add machine IP Address to your <code>/etc/hosts</code> file as <code>symfonos.local</code>.</p></blockquote>
<hr>
<p>Well, it&rsquo;s wordpress so <code>wpscan</code> to rescuse.
Using <code>wpscan --url http://symfonos.local/h3l105 --no-banner --no-update</code> reveals two CVEs, one is SQL Injection and other LFI vulnerability both in Mail Masta Plugin 1.0.</p>
<p><img src="/img/symfonos/symfonoswpscan.png" alt=""></p>
<h1 id="exploiting-lfi-vulnerabilty">Exploiting LFI Vulnerabilty</h1>
<p><a href="https://www.exploit-db.com/exploits/40290">Here</a>, shows LFI PoC. So implementing the PoC on <code>http://symfonos.local/h3l105</code>,</p>
<p>Visiting <code>http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd</code> reveals the content of <code>/etc/passwd</code>.</p>
<p><img src="/img/symfonos/symfonosetc.png" alt=""></p>
<p>We can also access <code>/wp-config.php</code>(this was not relevant) as well as some other files including <code>/var/mail/helios</code>.</p>
<p>I was completely clueless so I asked <a href="https://twitter.com/DCAU7">@DCAU7</a> for hint, he told me that I need to use SMTP to progress from here.</p>
<h1 id="smtp-enumeration-and-reverse-shell-via-smtp">SMTP Enumeration and Reverse Shell via SMTP</h1>
<p>Using telnet we can connect to SMTP and we can send data to <code>/var/mail/helios</code> since it&rsquo;s accessible through LFI vulnerability.</p>
<blockquote>
<p>telnet symfonos.local 25</p></blockquote>
<p>Once connected we can use it to execute our php code by accessing to <code>http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios</code>.</p>
<p><img src="/img/symfonos/symfonosvarmail.png" alt=""></p>
<p>First let&rsquo;s send a email to helios with our reverse shell</p>
<p>Using telnet we can connect to SMTP and from there we can send our reverse shell.</p>
<blockquote>
<p>telnet symfonos.local 25</p></blockquote>

<p><img src="/img/symfonos/symfonossmtp.png" alt=""></p>
<h1 id="getting-user-and-root">Getting User and Root</h1>
<p>So, once email will be sent we can route to <code>http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios</code> and that will execute our reverse shell.</p>
<p><img src="/img/symfonos/symfonosshell.png" alt=""></p>
<blockquote>
<p>find / -perm -u=s -type f 2&gt;/dev/null</p></blockquote>
<p><img src="/img/symfonos/symfonosfind.png" alt=""></p>
<p>Reveals a interesting file <code>/opt/statuscheck</code>, so analyzing that binary reveals that it is scraping the document info of that website. Using
<code>strings statuscheck</code> reveals that it&rsquo;s using curl i.e. <code>curl -I http://localhost.com</code> which basically gives the head information of a website. I tried to search for curl privilege escalation but sadly it wasn&rsquo;t useful.
I was stuck at this but <a href="https://twitter.com/0xmzfr">@mzfr</a> gave me a hint that it&rsquo;s something that we have done before.</p>
<p><img src="/img/symfonos/symfonosstrings.png" alt=""></p>
<p>So, that helped me a lot. I chnaged directory to <code>/tmp</code> folder and ceated a binary named curl by using following commands:-</p>

<p><img src="/img/symfonos/symfonosroot.png" alt=""></p>
<p>That was it folks.</p>
<h1 id="note">Note</h1>
<p>So, <a href="https://twittwer.com/0xmzfr">@mzfr</a> gained that reverse shell in a different way than mine. So, there are two ways to gain reverse shell to the symfonos machine.
Here&rsquo;s his <a href="https://mzfr.github.io/symfonos">writeup</a>.</p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 0 0 0-6 3 3 0 0 0 0 6"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/nmap-ctf-vulnhub/" rel="tag">nmap, ctf, vulnhub</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>




			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<input class="widget-search__field" type="search" placeholder="Search…" value="" name="q" aria-label="Search…">
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="http://localhost:1313/">
	</form>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/posts/crushftp-cve-2025-2825/">CVE 2025-2825 - CrushFTP Authentication Bypass Analysis</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/hpe-irs-cve-deep-dive/">Exploring Recent CVEs in HPE Insight Remote Support</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/ivanti-endpoint-manager-xxe-cve-2024-37397/">CVE 2024-37397 - Ivanti Endpoint Manager XXE Vulnerability</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/crushftp-cve-2024-4040/">CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/soccer-htb/">HackTheBox - Soccer</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">Categories</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/categories/cve-analysis/">CVE Analysis</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/hackthebox/">HackTheBox</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/pwning/">Pwning</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/vulnhub/">Vulnhub</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/nmap-ctf-vulnhub/" title="Nmap, Ctf, Vulnhub">Nmap, Ctf, Vulnhub (4)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/java/" title="Java">Java (3)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rce/" title="RCE">RCE (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/xxe/" title="XXE">XXE (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/.net/" title=".NET">.NET (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/auth-bypass/" title="Auth-Bypass">Auth-Bypass (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-37297/" title="CVE-2024-37297">CVE-2024-37297 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-4040/" title="Cve-2024-4040">Cve-2024-4040 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53675/" title="CVE-2024-53675">CVE-2024-53675 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53676/" title="CVE-2024-53676">CVE-2024-53676 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2025-2825/" title="CVE-2025-2825">CVE-2025-2825 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/dstat-sqlmap-upstream_proxy-websocket/" title="Dstat, Sqlmap, Upstream_proxy, Websocket">Dstat, Sqlmap, Upstream_proxy, Websocket (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/logic-flaw/" title="Logic-Flaw">Logic-Flaw (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/oob-xxe/" title="OOB-XXE">OOB-XXE (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/path-traversal/" title="Path Traversal">Path Traversal (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pwn-hackthebox-v8-kernel-heap-tcache-libc-2.29/" title="Pwn, Hackthebox, V8, Kernel, Heap, Tcache, Libc-2.29">Pwn, Hackthebox, V8, Kernel, Heap, Tcache, Libc-2.29 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pwn-tcache-libc-2.27-hackthebox/" title="Pwn, Tcache, Libc-2.27, Hackthebox">Pwn, Tcache, Libc-2.27, Hackthebox (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-bof-ret2csu-ctf/" title="Rop, Bof, Ret2csu, Ctf">Rop, Bof, Ret2csu, Ctf (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-pwn-bof/" title="Rop, Pwn, Bof">Rop, Pwn, Bof (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-pwn-radare2-pwntools/" title="Rop, Pwn, Radare2, Pwntools">Rop, Pwn, Radare2, Pwntools (1)</a>
		<a class="widget-taglist__link widget__link btn widget-taglist__link--all" href="/tags/">View all tags →</a>
	</div>
</div>

</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2025 .
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>