<!DOCTYPE html>
<html class="no-js" lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>HackTheBox - Only4You - Pwnfuzz Blog</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="Pwnfuzz Blog" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">Pwnfuzz Blog</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">HackTheBox - Only4You</h1>
			
		</header>
		<div class="content post__content clearfix">
			<p>Writeup for HackTheBox&rsquo;s Only4You machine.</p>
<!-- more -->
<p><code>only4you.htb</code> seemed like a static site with the <code>contact</code> functionality where we had some input fields, directory busting did not reveal anything interestin:</p>
<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled.png" alt=""></p>
<p>Doing the <code>vhost</code> scan, we can see that <code>beta.only4you.htb</code> :</p>

<p>It seems like an image conversion/resize website and it also allow us to download source code:</p>
<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled_1.png" alt=""></p>
<p>Downloading the source and analyzing the <code>[app.py](http://app.py)</code> :</p>


<p>We see that it has a download endpoint where it checks basic things for LFI like <code>../</code> characters and also checks if the given path is not absolute, check from the application’s upload directory but if the given path is absolute, then proceed to provide the file in the response. This can be taken into our advantage as we can specify the absolute path of any arbitrary file on the system and retrieve the contents of it, from example giving <code>../../../../.../../etc/paswd</code> will result in failure as it won’t pass the filter check but giving <code>/etc/passwd</code> which is the absolute path, the application will return the file contents.</p>
<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled_2.png" alt=""></p>
<p>From the further investigation, nothing interesting was found, since we know that there is the main website running, I checked the <code>error.log</code> for the <code>nginx</code> and it showed the directory path for the main site:</p>
<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled_3.png" alt=""></p>
<p>I grabbed that <code>[app.py](http://app.py)</code> from the <code>only4you.htb</code> directory from the <code>/var/www/</code></p>

<p>From the first glance the code had nothing interesting accept <code>form</code> module which was being imported, checking the <code>[form.py](http://form.py)</code> :</p>

<p>This script performs the pattern to check for the email address then split it in two half and check the address of the domain by calling <code>dig</code> via <code>[subprocess.run](http://subprocess.run)</code></p>

<p>Though the <code>regex</code> was used to check if the <code>pattern</code> matches the email then the second half was passed to the <code>dig</code> command, what we can do here is provide a valid mail and after that add a semicolon in the address, since <code>re.match</code> is used, once the pattern will be found it will return <code>True</code></p>
<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled_4.png" alt=""></p>
<p>As we can see that <code>;id</code> was given at the end of the mail address and is executed. Next, we can try the same payload on the website, here we can just provide the <code>wget</code> command to confirm if it is working and it made the connection to local HTTP Server:</p>
<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled_5.png" alt=""></p>

<p>Now, we just download the <code>[shel.sh](http://shel.sh)</code> file containing the reverse shell payload and then executing it with the next request with <code>bash /tmp/shell.sh</code></p>

<p>Doing so, we got the connection on the listener:</p>
<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled_6.png" alt=""></p>
<p>After doing initial enumeration, I noticed there were two users named <code>john</code> and <code>dev</code> and in the <code>/opt</code> folder, we see that there were two folders <code>gogs</code> and <code>internal_app</code> but we did not have permissions to check the folder, moving on, I saw that there were two ports in use <code>3000</code> and <code>8001</code></p>

<p>Since we do not have the SSH connection, I used the <code>chisel</code> to perform port forwarding:</p>

<p>Checking the port <code>3000</code> , it was running <code>gogs</code> and we did not have any credentials to check here:</p>
<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled_7.png" alt=""></p>
<p>Moving on to the port <code>8001</code> , it also had a login page:</p>
<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled_8.png" alt=""></p>
<p>Trying with the following credentials resulted in the application access:</p>

<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled_9.png" alt=""></p>
<p>The application had a task marked as completed that the transfer to <code>neo4j</code> database has been completed:</p>
<p>We also had a “Employee” page which allowed us to search for employees:</p>
<p>Giving a single quote in the search box resulted in <code>500</code> error:</p>
<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled_10.png" alt=""></p>
<p>Given, we already know that the backend database is <code>neo4j</code> , just a note that it differs from the SQL queries, <code>neo4j</code> uses Cypher Queries and for the Cypher queries one thing to note down is that every query must return some sort of the value. To check and confirm the hypothesis of the injection, there is a procedure named as <code>LOAD CSV FROM</code> which can be used to load arbitrary values from a remote server over HTTP connection. Here, we just tried to check if it makes the connection to our remote HTTP server:</p>

<p>Injecting the above query and checking the HTTP Server, we see that there were some requests made to it from <code>10.10.11.210</code></p>

<p>Next thing to try here is to extract <code>labels</code>  which is equivalent for SQL’s tables:</p>

<p>And on our HTTP server, we see that a request to <code>user</code> endpoint was made which means there is a label called <code>user</code></p>

<p>Now that we know the <code>label</code> , we can get the data from the <code>label</code>:</p>

<p>Injecting the payload resulted in several connections to our HTTP server revealing the hashes and usernames:</p>
<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled_11.png" alt=""></p>

<p>Cracking the <code>hashes</code> on the crackstation, we see that there is a hash which equals to <code>ThisIs4You</code> and that has belonged to <code>john</code> user:</p>
<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled_12.png" alt=""></p>

<p>Now, we can login to the SSH via the obtained credentials:</p>
<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled_13.png" alt=""></p>
<p>Once logged in and checking if there is any command that could be ran by <code>john</code> user:</p>

<p>Now, searching for any privilege escalation online for the <code>pip download</code>, I stumbled on the following post:</p>
<p><a href="https://embracethered.com/blog/posts/2022/python-package-manager-install-and-download-vulnerability/">https://embracethered.com/blog/posts/2022/python-package-manager-install-and-download-vulnerability/</a></p>
<p>Following the post, I just changed the <code>[setup.py](http://setup.py)</code> and used <code>os.system</code> to execute the same shell script that I had downloaded previously to the machine:</p>

<p>Now, we can just upload the <code>tar.gz</code> file to a repository on<code>gogs</code> using <code>john</code> credentials and then execute the command:</p>
<ul>
<li>Note that in order to run the <code>sudo pip download</code> , it only accepted a <code>tar.gz</code> file downloaded from the port <code>3000</code> of the localhost, so we needed to upload the <code>tar.gz</code> file to the <code>gogs</code></li>
</ul>

<p>I uploaded the <code>tar.gz</code> via <code>git</code> command as the web application for the <code>gogs</code> was too buggy over the tunneling, then executing the command, resulted in <code>root</code> :</p>
<p><img src="/img/OnlyForYou_6cf32928838a4b23bc4a47a1102c4daf/Untitled_14.png" alt=""></p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 0 0 0-6 3 3 0 0 0 0 6"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/python-flask-lfi-chisel-jtr-pip3/" rel="tag">python-flask, LFI, chisel, jtr, pip3</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>




			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<input class="widget-search__field" type="search" placeholder="Search…" value="" name="q" aria-label="Search…">
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="http://localhost:1313/">
	</form>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/posts/test-post/">Test Post for Summary</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/crushftp-cve-2025-2825/">CVE 2025-2825 - CrushFTP Authentication Bypass Analysis</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/hpe-irs-cve-deep-dive/">Exploring Recent CVEs in HPE Insight Remote Support</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/ivanti-endpoint-manager-xxe-cve-2024-37397/">CVE 2024-37397 - Ivanti Endpoint Manager XXE Vulnerability</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/crushftp-cve-2024-4040/">CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">Categories</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/categories/ctfs/">CTFs</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/cve-analysis/">CVE Analysis</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/exploit/">Exploit</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/hackthebox/">HackTheBox</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/pwning/">Pwning</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/testing/">Testing</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/vulnhub/">Vulnhub</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/.net/" title=".NET">.NET (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ansible-playbooks-cronjob-easy-java-seasonal-spring4shell/" title="Ansible-Playbooks, Cronjob, Easy, Java, Seasonal, Spring4shell">Ansible-Playbooks, Cronjob, Easy, Java, Seasonal, Spring4shell (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/auth-bypass/" title="Auth-Bypass">Auth-Bypass (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/bash-easy-eval-python-code-injection-relative-path-exploit/" title="Bash, Easy, Eval, Python-Code-Injection, Relative-Path-Exploit">Bash, Easy, Eval, Python-Code-Injection, Relative-Path-Exploit (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/blindsqlinjection-nosql-xss-pspy64/" title="BlindSQLInjection, NoSQL, XSS, Pspy64">BlindSQLInjection, NoSQL, XSS, Pspy64 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ctf-pwn-v8-browser-pwn/" title="Ctf, Pwn, V8, Browser Pwn">Ctf, Pwn, V8, Browser Pwn (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-37297/" title="CVE-2024-37297">CVE-2024-37297 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-4040/" title="Cve-2024-4040">Cve-2024-4040 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53675/" title="CVE-2024-53675">CVE-2024-53675 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53676/" title="CVE-2024-53676">CVE-2024-53676 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2025-2825/" title="CVE-2025-2825">CVE-2025-2825 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/debug/" title="Debug">Debug (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/dependencies-easy-pdfkit-ruby/" title="Dependencies, Easy, Pdfkit, Ruby">Dependencies, Easy, Pdfkit, Ruby (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/deserialisation/" title="Deserialisation">Deserialisation (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/dll/" title="DLL">DLL (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/dotnet/" title="Dotnet">Dotnet (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/dstat-sqlmap-upstream_proxy-websocket/" title="Dstat, Sqlmap, Upstream_proxy, Websocket">Dstat, Sqlmap, Upstream_proxy, Websocket (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/exploit-dev-egghunting/" title="Exploit-Dev, Egghunting">Exploit-Dev, Egghunting (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/java/" title="Java">Java (3)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/libc-2.27-heap-pwn-ctf-hitcon-tcache-roppy/" title="Libc-2.27, Heap, Pwn, Ctf, Hitcon, Tcache, Roppy">Libc-2.27, Heap, Pwn, Ctf, Hitcon, Tcache, Roppy (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/logic-flaw/" title="Logic-Flaw">Logic-Flaw (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/newtonsoft/" title="NewtonSoft">NewtonSoft (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/nmap-ctf-hackthebox-htb/" title="Nmap, Ctf, HacktheBox, Htb">Nmap, Ctf, HacktheBox, Htb (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/nmap-ctf-vulnhub/" title="Nmap, Ctf, Vulnhub">Nmap, Ctf, Vulnhub (8)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/oob-xxe/" title="OOB-XXE">OOB-XXE (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/path-traversal/" title="Path Traversal">Path Traversal (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pwn-ctf-__malloc_hook-rop-pwntools/" title="Pwn, Ctf, __Malloc_hook, Rop, Pwntools">Pwn, Ctf, __Malloc_hook, Rop, Pwntools (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pwn-fmtstr-bof-pwntools-canary/" title="Pwn, Fmtstr, Bof, Pwntools, Canary">Pwn, Fmtstr, Bof, Pwntools, Canary (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pwn-hackthebox-v8-kernel-heap-tcache-libc-2.29/" title="Pwn, Hackthebox, V8, Kernel, Heap, Tcache, Libc-2.29">Pwn, Hackthebox, V8, Kernel, Heap, Tcache, Libc-2.29 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pwn-roppy-ret2dlresolve/" title="Pwn, Roppy, Ret2dlresolve">Pwn, Roppy, Ret2dlresolve (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pwn-shellcode-egghunting-hackthebox/" title="Pwn, Shellcode, Egghunting, Hackthebox">Pwn, Shellcode, Egghunting, Hackthebox (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pwn-tcache-libc-2.27-hackthebox/" title="Pwn, Tcache, Libc-2.27, Hackthebox">Pwn, Tcache, Libc-2.27, Hackthebox (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/python/" title="Python">Python (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/python-flask-lfi-chisel-jtr-pip3/" title="Python-Flask, LFI, Chisel, Jtr, Pip3">Python-Flask, LFI, Chisel, Jtr, Pip3 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rce/" title="RCE">RCE (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-bof-ret2csu-ctf/" title="Rop, Bof, Ret2csu, Ctf">Rop, Bof, Ret2csu, Ctf (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-pwn-bof/" title="Rop, Pwn, Bof">Rop, Pwn, Bof (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-pwn-bof-syscall-zer0ctf/" title="Rop, Pwn, Bof, Syscall, Zer0ctf">Rop, Pwn, Bof, Syscall, Zer0ctf (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-pwn-radare2-pwntools/" title="Rop, Pwn, Radare2, Pwntools">Rop, Pwn, Radare2, Pwntools (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-pwn-ret2libc-bof/" title="Rop, Pwn, Ret2libc, Bof">Rop, Pwn, Ret2libc, Bof (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/smb-windows-mssql-server-hashcat-evil-winrm-responder.py/" title="Smb, Windows, Mssql-Server, Hashcat, Evil-Winrm, Responder.py">Smb, Windows, Mssql-Server, Hashcat, Evil-Winrm, Responder.py (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/sqlmap/" title="Sqlmap">Sqlmap (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ssti/" title="SSTI">SSTI (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/test/" title="Test">Test (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/unlink-htb-pwn-heap/" title="Unlink, Htb, Pwn, Heap">Unlink, Htb, Pwn, Heap (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/web-app/" title="Web-App">Web-App (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/websocket/" title="Websocket">Websocket (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/windows-htb/" title="Windows, Htb">Windows, Htb (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/xxe/" title="XXE">XXE (2)</a>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2025 Pwnfuzz Blog.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>