<!DOCTYPE html>
<html class="no-js" lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ROP- Basic Exploit Creation - Pwnfuzz Blog</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="Pwnfuzz Blog" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">Pwnfuzz Blog</div>
					
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/tags/">
				
				<span class="menu__text">Tags</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">About</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
    <article class="post">
        <header class="post__header">
            <h1 class="post__title">ROP- Basic Exploit Creation</h1>
            <div class="post__meta">
                <span class="post__author">
                    <i class="fas fa-user"></i> D4mianwayne
                </span>
                <span class="post__date">
                    <i class="far fa-calendar-alt"></i> July 26, 2019
                </span>
                
                <span class="post__categories">
                    <i class="fas fa-folder"></i>
                    
                        
                        <a href="/categories/pwning">Pwning</a>
                    
                </span>
                
                <span class="post__reading-time">
                    <i class="far fa-clock"></i> 3 min read
                </span>
            </div>
        </header>

        

        <div class="post__content clearfix">
            <p>This blog post will teach you basics of ROP i.e. how to use tools efficiently.</p>
<!-- more -->
<h1 id="overview">Overview</h1>
<p>This post is more practical, so tag along with radare2, pwntools, gdb and ropper ready. I&rsquo;m using <a href="https://ropemporium.com/binary/ret2win.zip">this</a> binary from ROP-Emporium and it&rsquo;s a basic one to start with. Grab it and read further.</p>
<h1 id="the-eip-and-rip-register">The EIP and RIP Register</h1>
<p>I&rsquo;m starting off with IP register i.e. Instruction Pointer in 16-bit mode, Extended Instruction Pointer in 32-bit architecture and RIP in 64-bit. It contains the address of next instruction that will be executed hence, controlling the flow of command. Consider this register as something that will have the control of program flow since it has the next instruction which has to be executed.</p>
<h1 id="analysis-of">Analysis of</h1>
<p>Let&rsquo;s run the binary and see what it says.</p>

<p>Using bunch of &ldquo;<strong>A</strong>s&rdquo; we can see we got a segmentation fault that means we got a buffer overflow that means there is no bound checking. Let&rsquo;s analyze the binary and see where is the input is overflowed.</p>
<p>As the first post contained radare2 as a resource for analysis of binary. Starting off with that, type <code>rabin2 -I ret2win</code> to get the information about the binary.</p>

<p>From above we now know that it&rsquo;s x86 arcitercture and a 64-bit ELF and endianess is set to little. Now, let&rsquo;s run <code>r2 ret2win</code> and see what functions it has.</p>

<p>So, we have a <code>sym.ret2win</code>, <code>sym.pwnme</code> and a <code>sym.main</code> which will be our focus for the rest. Since it&rsquo;s a ROP challenge and checking the functions one by one with <code>pdf @sym.ret2win</code> in radare2 shell.</p>

<p>We see that there is a string with <strong>/bin/cat flag.txt</strong> and a system function call of C, in case you don&rsquo;t know what <code>system</code> does, it executes the arguments as bash command.</p>
<p>Since we want to jump to address <code>0x00400811</code> in order to execute above function which will print our flag. In order to execute this we need to find the offset that we need to overwrite the instruction pointer. In this case, it is a 64-bit ELF we have to find <strong>RIP</strong> if it was 32-bit ELF we had to find <strong>EIP</strong>. Let&rsquo;s try to create a pattern offset uding gdb.</p>

<h5 id="command-explaination">Command Explaination</h5>
<ul>
<li><code>gdb ret2win</code> : This will open the gdb with ret2win binary for the processing.</li>
<li><code>pattern_create 100 input</code> : This will create a offset pattern of the length provided, in our case it&rsquo;s 100. <code>input</code> is the file where the offset willbe written.</li>
<li><code>r &lt; input</code> : This will run the binary ret2win and gives the <code>input</code> file as input.</li>
</ul>
<h1 id="analyzing-the-offsets">Analyzing the offsets</h1>
<p>Let&rsquo;s see the peda&rsquo;s work and informatio it provided us:-</p>

<p>In 64-bit binaries we can see the RIP doesn&rsquo;t contain our sequence. In 64-bit, it will not pop a value into RIP if it cannot actually jump to the address and execute it. So the value is at top of the stack after popping to RIP failed. So from above we can see that RSP has the pattern, we can get value from it. As we can see it has a value of <strong>&ldquo;AA0AAFAAb&rdquo;</strong> at the time of segment fault.</p>
<p>Time to find the padding we need in order to execute the instruction properly. Using peda:-</p>

<h1 id="creating-exploit">Creating Exploit</h1>
<p>Now, we have all we need to execute the exploit. Now let&rsquo;s craft the exploit.
We need the memory address of RIP and the padding length and python, of course.</p>
<p>Using pwntools to craft exploit:-</p>

<p>Now, run the exploit:-</p>

<p>Bam, we read the flag by pushing the <code>pop rbp</code> address to RIP hence executing our payload.</p>
<p>Follow me on <a href="https://twitter.com/d4mianwayne">twitter</a> for more ROP contents.</p>

        </div>

        
        <footer class="post__footer">
            <div class="post-tags">
                <i class="fas fa-tags"></i>
                
                    <a href="/tags/rop-pwn-radare2-pwntools" class="tag">rop, pwn, radare2, pwntools</a>
                
            </div>
        </footer>
        
    </article>

    <div class="post-navigation">
        
            <a href="/2019/07/introduction-to-rop/" class="post-navigation__prev">
                <i class="fas fa-arrow-left"></i>
                <span>Introduction to ROP</span>
            </a>
        
        
            <a href="/2019/07/rop-ret2libc-attack/" class="post-navigation__next">
                <span>ROP - ret2libc attack</span>
                <i class="fas fa-arrow-right"></i>
            </a>
        
    </div>
</main>

			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<input class="widget-search__field" type="search" placeholder="Search…" value="" name="q" aria-label="Search…">
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="http://localhost:1313/">
	</form>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/2025/03/cve-2025-2825-crushftp-authentication-bypass-analysis/">CVE 2025-2825 - CrushFTP Authentication Bypass Analysis</a></li>
			<li class="widget__item"><a class="widget__link" href="/2025/01/exploring-recent-cves-in-hpe-insight-remote-support/">Exploring Recent CVEs in HPE Insight Remote Support</a></li>
			<li class="widget__item"><a class="widget__link" href="/2024/11/cve-2024-37397-ivanti-endpoint-manager-xxe-vulnerability/">CVE 2024-37397 - Ivanti Endpoint Manager XXE Vulnerability</a></li>
			<li class="widget__item"><a class="widget__link" href="/2024/05/cve-2024-4040-crushftp-server-side-template-injection-vulnerability-analysis/">CVE 2024-4040 - CrushFTP Server-Side Template Injection Vulnerability Analysis</a></li>
			<li class="widget__item"><a class="widget__link" href="/2023/06/hackthebox-soccer/">HackTheBox - Soccer</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">Categories</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/categories/cve-analysis/">CVE Analysis</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/hackthebox/">HackTheBox</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/pwning/">Pwning</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/vulnhub/">Vulnhub</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/.net/" title=".NET">.NET (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/auth-bypass/" title="Auth-Bypass">Auth-Bypass (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-37297/" title="CVE-2024-37297">CVE-2024-37297 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-4040/" title="Cve-2024-4040">Cve-2024-4040 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53675/" title="CVE-2024-53675">CVE-2024-53675 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2024-53676/" title="CVE-2024-53676">CVE-2024-53676 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cve-2025-2825/" title="CVE-2025-2825">CVE-2025-2825 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/dstat-sqlmap-upstream_proxy-websocket/" title="Dstat, Sqlmap, Upstream_proxy, Websocket">Dstat, Sqlmap, Upstream_proxy, Websocket (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/java/" title="Java">Java (3)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/logic-flaw/" title="Logic-Flaw">Logic-Flaw (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/nmap-ctf-vulnhub/" title="Nmap, Ctf, Vulnhub">Nmap, Ctf, Vulnhub (4)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/oob-xxe/" title="OOB-XXE">OOB-XXE (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/path-traversal/" title="Path Traversal">Path Traversal (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pwn-hackthebox-v8-kernel-heap-tcache-libc-2.29/" title="Pwn, Hackthebox, V8, Kernel, Heap, Tcache, Libc-2.29">Pwn, Hackthebox, V8, Kernel, Heap, Tcache, Libc-2.29 (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pwn-tcache-libc-2.27-hackthebox/" title="Pwn, Tcache, Libc-2.27, Hackthebox">Pwn, Tcache, Libc-2.27, Hackthebox (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rce/" title="RCE">RCE (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-bof-ret2csu-ctf/" title="Rop, Bof, Ret2csu, Ctf">Rop, Bof, Ret2csu, Ctf (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-pwn-bof/" title="Rop, Pwn, Bof">Rop, Pwn, Bof (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-pwn-radare2-pwntools/" title="Rop, Pwn, Radare2, Pwntools">Rop, Pwn, Radare2, Pwntools (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rop-pwn-ret2libc-bof/" title="Rop, Pwn, Ret2libc, Bof">Rop, Pwn, Ret2libc, Bof (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ssti/" title="SSTI">SSTI (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/xxe/" title="XXE">XXE (2)</a>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2025 Pwnfuzz Blog.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>